[2024-12-03T00:13:32.367+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-03T00:13:32.412+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: kafka_hive_pipeline_threaded.sync_producer_and_consumer manual__2024-12-03T00:13:16.991150+00:00 [queued]>
[2024-12-03T00:13:32.450+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: kafka_hive_pipeline_threaded.sync_producer_and_consumer manual__2024-12-03T00:13:16.991150+00:00 [queued]>
[2024-12-03T00:13:32.452+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 1
[2024-12-03T00:13:32.546+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): sync_producer_and_consumer> on 2024-12-03 00:13:16.991150+00:00
[2024-12-03T00:13:32.565+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'kafka_hive_pipeline_threaded', 'sync_producer_and_consumer', 'manual__2024-12-03T00:13:16.991150+00:00', '--job-id', '172', '--raw', '--subdir', 'DAGS_FOLDER/gestion_airflow.py', '--cfg-path', '/tmp/tmpro6swwt2']
[2024-12-03T00:13:32.571+0000] {standard_task_runner.py:105} INFO - Job 172: Subtask sync_producer_and_consumer
[2024-12-03T00:13:32.574+0000] {logging_mixin.py:190} WARNING - /home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=7698) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-12-03T00:13:32.576+0000] {standard_task_runner.py:72} INFO - Started process 7712 to run task
[2024-12-03T00:13:32.812+0000] {task_command.py:467} INFO - Running <TaskInstance: kafka_hive_pipeline_threaded.sync_producer_and_consumer manual__2024-12-03T00:13:16.991150+00:00 [running]> on host 45770b1a429e
[2024-12-03T00:13:33.208+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='kafka_hive_pipeline_threaded' AIRFLOW_CTX_TASK_ID='sync_producer_and_consumer' AIRFLOW_CTX_EXECUTION_DATE='2024-12-03T00:13:16.991150+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-12-03T00:13:16.991150+00:00'
[2024-12-03T00:13:33.212+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-03T00:13:33.441+0000] {csv_to_kafka_with_redis.py:50} INFO - Loaded CSV Data:
    Invoice ID Branch       City  ... gross margin percentage gross income Rating
0  750-67-8428      A     Yangon  ...                4.761905      26.1415    9.1
1  226-31-3081      C  Naypyitaw  ...                4.761905       3.8200    9.6
2  631-41-3108      A     Yangon  ...                4.761905      16.2155    7.4
3  123-19-1176      A     Yangon  ...                4.761905      23.2880    8.4
4  373-73-7910      A     Yangon  ...                4.761905      30.2085    5.3

[5 rows x 17 columns]
[2024-12-03T00:13:33.446+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '788e1345-2206-482b-aeac-b2885ea1da72', 'invoice_id': '750-67-8428', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 74.69, 'quantity': 7, 'tax_5_percent': 26.1415, 'total': 548.9715, 'date': '1/5/2019', 'time': '13:08', 'payment': 'Ewallet', 'cogs': 522.83, 'gross_margin_percentage': 4.761904762, 'gross_income': 26.1415, 'rating': 9.1}
[2024-12-03T00:13:33.487+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '2d65af39-a87f-46c2-89f5-89322e03d83d', 'invoice_id': '226-31-3081', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 15.28, 'quantity': 5, 'tax_5_percent': 3.82, 'total': 80.22, 'date': '3/8/2019', 'time': '10:29', 'payment': 'Cash', 'cogs': 76.4, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.82, 'rating': 9.6}
[2024-12-03T00:13:33.489+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '5dba66fc-f010-43cd-87e2-74a16aa8670d', 'invoice_id': '631-41-3108', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 46.33, 'quantity': 7, 'tax_5_percent': 16.2155, 'total': 340.5255, 'date': '3/3/2019', 'time': '13:23', 'payment': 'Credit card', 'cogs': 324.31, 'gross_margin_percentage': 4.761904762, 'gross_income': 16.2155, 'rating': 7.4}
[2024-12-03T00:13:33.491+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'e618cea4-e240-4055-9c7a-2c08a309daa7', 'invoice_id': '123-19-1176', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 58.22, 'quantity': 8, 'tax_5_percent': 23.288, 'total': 489.048, 'date': '1/27/2019', 'time': '20:33', 'payment': 'Ewallet', 'cogs': 465.76, 'gross_margin_percentage': 4.761904762, 'gross_income': 23.288, 'rating': 8.4}
[2024-12-03T00:13:33.493+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '6027c34f-5bf6-443c-aff0-7fdcc5ec543c', 'invoice_id': '373-73-7910', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 86.31, 'quantity': 7, 'tax_5_percent': 30.2085, 'total': 634.3785, 'date': '2/8/2019', 'time': '10:37', 'payment': 'Ewallet', 'cogs': 604.17, 'gross_margin_percentage': 4.761904762, 'gross_income': 30.2085, 'rating': 5.3}
[2024-12-03T00:13:33.495+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'af378ef8-cf15-4de8-94ca-e13d85e426e6', 'invoice_id': '699-14-3026', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 85.39, 'quantity': 7, 'tax_5_percent': 29.8865, 'total': 627.6165, 'date': '3/25/2019', 'time': '18:30', 'payment': 'Ewallet', 'cogs': 597.73, 'gross_margin_percentage': 4.761904762, 'gross_income': 29.8865, 'rating': 4.1}
[2024-12-03T00:13:33.497+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'a681b2d2-decb-414b-8e66-7eabfdcc7e36', 'invoice_id': '355-53-5943', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 68.84, 'quantity': 6, 'tax_5_percent': 20.652, 'total': 433.692, 'date': '2/25/2019', 'time': '14:36', 'payment': 'Ewallet', 'cogs': 413.04, 'gross_margin_percentage': 4.761904762, 'gross_income': 20.652, 'rating': 5.8}
[2024-12-03T00:13:33.500+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'e3a77f2c-a68c-41ae-b00b-f325ea872501', 'invoice_id': '315-22-5665', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 73.56, 'quantity': 10, 'tax_5_percent': 36.78, 'total': 772.38, 'date': '2/24/2019', 'time': '11:38', 'payment': 'Ewallet', 'cogs': 735.6, 'gross_margin_percentage': 4.761904762, 'gross_income': 36.78, 'rating': 8.0}
[2024-12-03T00:13:33.503+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '93332886-a148-44e0-9bb7-cf2ff46cf8bf', 'invoice_id': '665-32-9167', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 36.26, 'quantity': 2, 'tax_5_percent': 3.626, 'total': 76.146, 'date': '1/10/2019', 'time': '17:15', 'payment': 'Credit card', 'cogs': 72.52, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.626, 'rating': 7.2}
[2024-12-03T00:13:33.506+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '7043eb1e-0d98-4699-b8c9-1b1e17989310', 'invoice_id': '692-92-5582', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 54.84, 'quantity': 3, 'tax_5_percent': 8.226, 'total': 172.746, 'date': '2/20/2019', 'time': '13:27', 'payment': 'Credit card', 'cogs': 164.52, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.226, 'rating': 5.9}
[2024-12-03T00:13:33.507+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'fd3af7eb-9d63-44c5-bcdc-4eff03071926', 'invoice_id': '351-62-0822', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 14.48, 'quantity': 4, 'tax_5_percent': 2.896, 'total': 60.816, 'date': '2/6/2019', 'time': '18:07', 'payment': 'Ewallet', 'cogs': 57.92, 'gross_margin_percentage': 4.761904762, 'gross_income': 2.896, 'rating': 4.5}
[2024-12-03T00:13:33.510+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'a569f8d9-2592-4946-b018-fd17772338a0', 'invoice_id': '529-56-3974', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 25.51, 'quantity': 4, 'tax_5_percent': 5.102, 'total': 107.142, 'date': '3/9/2019', 'time': '17:03', 'payment': 'Cash', 'cogs': 102.04, 'gross_margin_percentage': 4.761904762, 'gross_income': 5.102, 'rating': 6.8}
[2024-12-03T00:13:33.512+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '05266037-3467-480a-8307-b59503341481', 'invoice_id': '365-64-0515', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 46.95, 'quantity': 5, 'tax_5_percent': 11.7375, 'total': 246.4875, 'date': '2/12/2019', 'time': '10:25', 'payment': 'Ewallet', 'cogs': 234.75, 'gross_margin_percentage': 4.761904762, 'gross_income': 11.7375, 'rating': 7.1}
[2024-12-03T00:13:33.514+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '4f17810f-8fc3-42c2-b033-52e4c6e560aa', 'invoice_id': '252-56-2699', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Food and beverages', 'unit_price': 43.19, 'quantity': 10, 'tax_5_percent': 21.595, 'total': 453.495, 'date': '2/7/2019', 'time': '16:48', 'payment': 'Ewallet', 'cogs': 431.9, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.595, 'rating': 8.2}
[2024-12-03T00:13:33.518+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '60d3ff80-c1bf-4928-948e-7b858fc469fd', 'invoice_id': '829-34-3910', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 71.38, 'quantity': 10, 'tax_5_percent': 35.69, 'total': 749.49, 'date': '3/29/2019', 'time': '19:21', 'payment': 'Cash', 'cogs': 713.8, 'gross_margin_percentage': 4.761904762, 'gross_income': 35.69, 'rating': 5.7}
[2024-12-03T00:13:33.520+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'f0d6e074-a479-432e-8499-d583b721122c', 'invoice_id': '299-46-1805', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 93.72, 'quantity': 6, 'tax_5_percent': 28.116, 'total': 590.436, 'date': '1/15/2019', 'time': '16:19', 'payment': 'Cash', 'cogs': 562.32, 'gross_margin_percentage': 4.761904762, 'gross_income': 28.116, 'rating': 4.5}
[2024-12-03T00:13:33.522+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'b1d1c1ce-3aaa-480e-b3ce-0cc3567c68ac', 'invoice_id': '656-95-9349', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 68.93, 'quantity': 7, 'tax_5_percent': 24.1255, 'total': 506.6355, 'date': '3/11/2019', 'time': '11:03', 'payment': 'Credit card', 'cogs': 482.51, 'gross_margin_percentage': 4.761904762, 'gross_income': 24.1255, 'rating': 4.6}
[2024-12-03T00:13:33.523+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '6bb5089f-7f67-45df-89ac-9c59cf885912', 'invoice_id': '765-26-6951', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 72.61, 'quantity': 6, 'tax_5_percent': 21.783, 'total': 457.443, 'date': '1/1/2019', 'time': '10:39', 'payment': 'Credit card', 'cogs': 435.66, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.783, 'rating': 6.9}
[2024-12-03T00:13:33.526+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '03c10ccb-6645-4d0a-834b-3687eabac821', 'invoice_id': '329-62-1586', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Food and beverages', 'unit_price': 54.67, 'quantity': 3, 'tax_5_percent': 8.2005, 'total': 172.2105, 'date': '1/21/2019', 'time': '18:00', 'payment': 'Credit card', 'cogs': 164.01, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.2005, 'rating': 8.6}
[2024-12-03T00:13:33.528+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '06963420-6793-4ba6-8a33-d8eccd3d4202', 'invoice_id': '319-50-3348', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 40.3, 'quantity': 2, 'tax_5_percent': 4.03, 'total': 84.63, 'date': '3/11/2019', 'time': '15:30', 'payment': 'Ewallet', 'cogs': 80.6, 'gross_margin_percentage': 4.761904762, 'gross_income': 4.03, 'rating': 4.4}
[2024-12-03T00:13:33.530+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '0f9ad17a-7c4b-4d2a-a76c-6c90b4180380', 'invoice_id': '300-71-4605', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 86.04, 'quantity': 5, 'tax_5_percent': 21.51, 'total': 451.71, 'date': '2/25/2019', 'time': '11:24', 'payment': 'Ewallet', 'cogs': 430.2, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.51, 'rating': 4.8}
[2024-12-03T00:13:33.534+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '21dc2b46-fe5b-4807-8dec-4096b3a7504b', 'invoice_id': '371-85-5789', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 87.98, 'quantity': 3, 'tax_5_percent': 13.197, 'total': 277.137, 'date': '3/5/2019', 'time': '10:40', 'payment': 'Ewallet', 'cogs': 263.94, 'gross_margin_percentage': 4.761904762, 'gross_income': 13.197, 'rating': 5.1}
[2024-12-03T00:13:33.536+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'c0744e8b-7f93-4b91-ab64-c22fa6ffbeb6', 'invoice_id': '273-16-6619', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 33.2, 'quantity': 2, 'tax_5_percent': 3.32, 'total': 69.72, 'date': '3/15/2019', 'time': '12:20', 'payment': 'Credit card', 'cogs': 66.4, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.32, 'rating': 4.4}
[2024-12-03T00:13:33.538+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '0d783d65-7f3e-4c39-9103-1c5cc129ba86', 'invoice_id': '636-48-8204', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 34.56, 'quantity': 5, 'tax_5_percent': 8.64, 'total': 181.44, 'date': '2/17/2019', 'time': '11:15', 'payment': 'Ewallet', 'cogs': 172.8, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.64, 'rating': 9.9}
[2024-12-03T00:13:33.539+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '708e7ae6-b7c1-4c03-aa9f-13a61c64313c', 'invoice_id': '549-59-1358', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 88.63, 'quantity': 3, 'tax_5_percent': 13.2945, 'total': 279.1845, 'date': '3/2/2019', 'time': '17:36', 'payment': 'Ewallet', 'cogs': 265.89, 'gross_margin_percentage': 4.761904762, 'gross_income': 13.2945, 'rating': 6.0}
[2024-12-03T00:13:33.541+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'cb7249e0-02ef-468f-b3d3-07a2b8a1ea0f', 'invoice_id': '227-03-5010', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 52.59, 'quantity': 8, 'tax_5_percent': 21.036, 'total': 441.756, 'date': '3/22/2019', 'time': '19:20', 'payment': 'Credit card', 'cogs': 420.72, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.036, 'rating': 8.5}
[2024-12-03T00:13:33.544+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '859d4d91-8eed-4bf9-be5d-f86ab6611120', 'invoice_id': '649-29-6775', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Fashion accessories', 'unit_price': 33.52, 'quantity': 1, 'tax_5_percent': 1.676, 'total': 35.196, 'date': '2/8/2019', 'time': '15:31', 'payment': 'Cash', 'cogs': 33.52, 'gross_margin_percentage': 4.761904762, 'gross_income': 1.676, 'rating': 6.7}
[2024-12-03T00:13:33.546+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '2b9b5801-f9ff-496f-af35-d1fd8b371b1f', 'invoice_id': '189-17-4241', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 87.67, 'quantity': 2, 'tax_5_percent': 8.767, 'total': 184.107, 'date': '3/10/2019', 'time': '12:17', 'payment': 'Credit card', 'cogs': 175.34, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.767, 'rating': 7.7}
[2024-12-03T00:13:33.548+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '172e5f72-e724-4c26-829a-27ed98aa22d2', 'invoice_id': '145-94-9061', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 88.36, 'quantity': 5, 'tax_5_percent': 22.09, 'total': 463.89, 'date': '1/25/2019', 'time': '19:48', 'payment': 'Cash', 'cogs': 441.8, 'gross_margin_percentage': 4.761904762, 'gross_income': 22.09, 'rating': 9.6}
[2024-12-03T00:13:33.551+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'b889cd73-f833-4862-a1e1-a443c8e32331', 'invoice_id': '848-62-7243', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 24.89, 'quantity': 9, 'tax_5_percent': 11.2005, 'total': 235.2105, 'date': '3/15/2019', 'time': '15:36', 'payment': 'Cash', 'cogs': 224.01, 'gross_margin_percentage': 4.761904762, 'gross_income': 11.2005, 'rating': 7.4}
[2024-12-03T00:13:33.554+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '26d1c4bf-eb45-4ac8-800d-9e447a4d67b3', 'invoice_id': '871-79-8483', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Fashion accessories', 'unit_price': 94.13, 'quantity': 5, 'tax_5_percent': 23.5325, 'total': 494.1825, 'date': '2/25/2019', 'time': '19:39', 'payment': 'Credit card', 'cogs': 470.65, 'gross_margin_percentage': 4.761904762, 'gross_income': 23.5325, 'rating': 4.8}
[2024-12-03T00:13:33.555+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '5f9aec9b-e457-4aa7-8626-b94856046e14', 'invoice_id': '149-71-6266', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 78.07, 'quantity': 9, 'tax_5_percent': 35.1315, 'total': 737.7615, 'date': '1/28/2019', 'time': '12:43', 'payment': 'Cash', 'cogs': 702.63, 'gross_margin_percentage': 4.761904762, 'gross_income': 35.1315, 'rating': 4.5}
[2024-12-03T00:13:33.558+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '3feee33f-85bf-481c-9bfe-90d0e6df78f0', 'invoice_id': '640-49-2076', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 83.78, 'quantity': 8, 'tax_5_percent': 33.512, 'total': 703.752, 'date': '1/10/2019', 'time': '14:49', 'payment': 'Cash', 'cogs': 670.24, 'gross_margin_percentage': 4.761904762, 'gross_income': 33.512, 'rating': 5.1}
[2024-12-03T00:13:33.560+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'd1c80d2d-69bc-4dbd-bd49-33d093192406', 'invoice_id': '595-11-5460', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 96.58, 'quantity': 2, 'tax_5_percent': 9.658, 'total': 202.818, 'date': '3/15/2019', 'time': '10:12', 'payment': 'Credit card', 'cogs': 193.16, 'gross_margin_percentage': 4.761904762, 'gross_income': 9.658, 'rating': 5.1}
[2024-12-03T00:13:33.562+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '352f2d53-75a5-49b8-8238-0db09d31b6c8', 'invoice_id': '183-56-6882', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 99.42, 'quantity': 4, 'tax_5_percent': 19.884, 'total': 417.564, 'date': '2/6/2019', 'time': '10:42', 'payment': 'Ewallet', 'cogs': 397.68, 'gross_margin_percentage': 4.761904762, 'gross_income': 19.884, 'rating': 7.5}
[2024-12-03T00:13:33.564+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '9635b00b-3332-4f3b-ab56-810d5020741b', 'invoice_id': '232-16-2483', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 68.12, 'quantity': 1, 'tax_5_percent': 3.406, 'total': 71.526, 'date': '1/7/2019', 'time': '12:28', 'payment': 'Ewallet', 'cogs': 68.12, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.406, 'rating': 6.8}
[2024-12-03T00:13:33.567+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '65651dad-9411-40e7-a2c2-f343af2be31a', 'invoice_id': '129-29-8530', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 62.62, 'quantity': 5, 'tax_5_percent': 15.655, 'total': 328.755, 'date': '3/10/2019', 'time': '19:15', 'payment': 'Ewallet', 'cogs': 313.1, 'gross_margin_percentage': 4.761904762, 'gross_income': 15.655, 'rating': 7.0}
[2024-12-03T00:13:33.570+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '55f9ce75-a54d-4987-a935-9b8d9f04fe4c', 'invoice_id': '272-65-1806', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 60.88, 'quantity': 9, 'tax_5_percent': 27.396, 'total': 575.316, 'date': '1/15/2019', 'time': '17:17', 'payment': 'Ewallet', 'cogs': 547.92, 'gross_margin_percentage': 4.761904762, 'gross_income': 27.396, 'rating': 4.7}
[2024-12-03T00:13:33.572+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': 'bf3689c4-3246-4307-bd04-3229ea91597e', 'invoice_id': '333-73-7901', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 54.92, 'quantity': 8, 'tax_5_percent': 21.968, 'total': 461.328, 'date': '3/23/2019', 'time': '13:24', 'payment': 'Ewallet', 'cogs': 439.36, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.968, 'rating': 7.6}
[2024-12-03T00:13:33.574+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '404b10ea-6d63-48c8-be81-f07e344c7b5a', 'invoice_id': '777-82-7220', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 30.12, 'quantity': 8, 'tax_5_percent': 12.048, 'total': 253.008, 'date': '3/3/2019', 'time': '13:01', 'payment': 'Cash', 'cogs': 240.96, 'gross_margin_percentage': 4.761904762, 'gross_income': 12.048, 'rating': 7.7}
[2024-12-03T00:13:33.577+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '3a70a1f1-6287-4e93-9f70-c277544d40dd', 'invoice_id': '280-35-5823', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 86.72, 'quantity': 1, 'tax_5_percent': 4.336, 'total': 91.056, 'date': '1/17/2019', 'time': '18:45', 'payment': 'Ewallet', 'cogs': 86.72, 'gross_margin_percentage': 4.761904762, 'gross_income': 4.336, 'rating': 7.9}
[2024-12-03T00:13:33.580+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '01054482-e9c4-4f8c-a303-14c73501e3f8', 'invoice_id': '554-53-8700', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 56.11, 'quantity': 2, 'tax_5_percent': 5.611, 'total': 117.831, 'date': '2/2/2019', 'time': '10:11', 'payment': 'Cash', 'cogs': 112.22, 'gross_margin_percentage': 4.761904762, 'gross_income': 5.611, 'rating': 6.3}
[2024-12-03T00:13:33.582+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '203ff596-e920-41ac-950e-3556268549ed', 'invoice_id': '354-25-5821', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 69.12, 'quantity': 6, 'tax_5_percent': 20.736, 'total': 435.456, 'date': '2/8/2019', 'time': '13:03', 'payment': 'Cash', 'cogs': 414.72, 'gross_margin_percentage': 4.761904762, 'gross_income': 20.736, 'rating': 5.6}
[2024-12-03T00:13:33.585+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '7148c58f-6ae2-40cc-bc29-5e49aebacb39', 'invoice_id': '228-96-1411', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 98.7, 'quantity': 8, 'tax_5_percent': 39.48, 'total': 829.08, 'date': '3/4/2019', 'time': '20:39', 'payment': 'Cash', 'cogs': 789.6, 'gross_margin_percentage': 4.761904762, 'gross_income': 39.48, 'rating': 7.6}
[2024-12-03T00:13:33.587+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '115e9759-2cc7-4858-9d0c-ef3ac1a002be', 'invoice_id': '617-15-4209', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 15.37, 'quantity': 2, 'tax_5_percent': 1.537, 'total': 32.277, 'date': '3/16/2019', 'time': '19:47', 'payment': 'Cash', 'cogs': 30.74, 'gross_margin_percentage': 4.761904762, 'gross_income': 1.537, 'rating': 7.2}
[2024-12-03T00:13:33.589+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '40e6e2b1-fa84-438c-86c5-19a5f460895d', 'invoice_id': '132-32-9879', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 93.96, 'quantity': 4, 'tax_5_percent': 18.792, 'total': 394.632, 'date': '3/9/2019', 'time': '18:00', 'payment': 'Cash', 'cogs': 375.84, 'gross_margin_percentage': 4.761904762, 'gross_income': 18.792, 'rating': 9.5}
[2024-12-03T00:13:33.591+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '83b04815-0a6f-4a75-95bb-2a755580c5a4', 'invoice_id': '370-41-7321', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 56.69, 'quantity': 9, 'tax_5_percent': 25.5105, 'total': 535.7205, 'date': '2/27/2019', 'time': '17:24', 'payment': 'Credit card', 'cogs': 510.21, 'gross_margin_percentage': 4.761904762, 'gross_income': 25.5105, 'rating': 8.4}
[2024-12-03T00:13:33.594+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '48dbfdfb-45ee-497b-8a35-64475bda97b9', 'invoice_id': '727-46-3608', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 20.01, 'quantity': 9, 'tax_5_percent': 9.0045, 'total': 189.0945, 'date': '2/6/2019', 'time': '15:47', 'payment': 'Ewallet', 'cogs': 180.09, 'gross_margin_percentage': 4.761904762, 'gross_income': 9.0045, 'rating': 4.1}
[2024-12-03T00:13:33.597+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '5db2a3ba-d5b4-4189-a996-b0592d0c5edb', 'invoice_id': '669-54-1719', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 18.93, 'quantity': 6, 'tax_5_percent': 5.679, 'total': 119.259, 'date': '2/10/2019', 'time': '12:45', 'payment': 'Credit card', 'cogs': 113.58, 'gross_margin_percentage': 4.761904762, 'gross_income': 5.679, 'rating': 8.1}
[2024-12-03T00:13:33.600+0000] {csv_to_kafka_with_redis.py:84} INFO - Row data before serialization: {'id': '1390018b-58dc-420c-9775-46d6698bd3b6', 'invoice_id': '574-22-5561', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 82.63, 'quantity': 10, 'tax_5_percent': 41.315, 'total': 867.615, 'date': '3/19/2019', 'time': '17:08', 'payment': 'Ewallet', 'cogs': 826.3, 'gross_margin_percentage': 4.761904762, 'gross_income': 41.315, 'rating': 7.9}
[2024-12-03T00:13:34.322+0000] {csv_to_kafka_with_redis.py:94} INFO - Batch 1 envoyé à Kafka.
[2024-12-03T00:13:34.368+0000] {csv_to_kafka_with_redis.py:98} INFO - Redis batch status: READY
[2024-12-03T00:13:34.369+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:34.653+0000] {hive.py:475} INFO - USE `default`
[2024-12-03T00:13:35.052+0000] {hive.py:475} INFO - 
    CREATE TABLE IF NOT EXISTS sales (
        id STRING,
        invoice_id STRING,
        branch STRING,
        city STRING,
        customer_type STRING,
        gender STRING,
        product_line STRING,
        unit_price FLOAT,
        quantity INT,
        tax_5_percent FLOAT,
        total FLOAT,
        `date` STRING,
        time STRING,
        payment STRING,
        cogs FLOAT,
        gross_margin_percentage FLOAT,
        gross_income FLOAT,
        rating FLOAT
    ) STORED AS ORC
    
[2024-12-03T00:13:35.371+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:35.846+0000] {kafka_to_hive_with_redis.py:72} INFO - Subscribed to topic 'topic-batch'
[2024-12-03T00:13:36.374+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:37.377+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:38.379+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:39.381+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:40.385+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:41.387+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:42.390+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:43.392+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:44.394+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:45.396+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:46.399+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:47.403+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:48.405+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:49.407+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:50.409+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:51.411+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:52.413+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:53.415+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:54.418+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:55.420+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:56.423+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:57.425+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:58.419+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:13:59.421+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:00.423+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:01.425+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:02.426+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:03.429+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:04.431+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:05.440+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:06.448+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:07.452+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:08.457+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:09.505+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:10.540+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:11.572+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:12.600+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:13.619+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:14.644+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:15.672+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:16.699+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:17.717+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:18.727+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:19.730+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:20.732+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:21.734+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:22.736+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:23.738+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:24.741+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:25.744+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:26.747+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:27.750+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:28.751+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:29.753+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:30.755+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:31.757+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:32.759+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:33.762+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:34.765+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:35.767+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:36.769+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:37.771+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:38.773+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:39.776+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:40.779+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:41.784+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:42.786+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:43.788+0000] {csv_to_kafka_with_redis.py:102} INFO - En attente du consommateur...
[2024-12-03T00:14:44.185+0000] {local_task_job_runner.py:346} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2024-12-03T00:14:44.186+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2024-12-03T00:14:44.194+0000] {process_utils.py:132} INFO - Sending 15 to group 7712. PIDs of all processes in the group: [7712]
[2024-12-03T00:14:44.195+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 7712
[2024-12-03T00:14:44.196+0000] {taskinstance.py:3093} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-12-03T00:14:44.254+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-03T00:14:44.289+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=7712, status='terminated', exitcode=0, started='00:13:31') (7712) terminated with exit code 0
