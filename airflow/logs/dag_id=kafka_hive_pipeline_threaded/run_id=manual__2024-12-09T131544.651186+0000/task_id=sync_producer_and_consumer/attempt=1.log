[2024-12-09T13:15:55.379+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-09T13:15:55.426+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: kafka_hive_pipeline_threaded.sync_producer_and_consumer manual__2024-12-09T13:15:44.651186+00:00 [queued]>
[2024-12-09T13:15:55.464+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: kafka_hive_pipeline_threaded.sync_producer_and_consumer manual__2024-12-09T13:15:44.651186+00:00 [queued]>
[2024-12-09T13:15:55.465+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 1
[2024-12-09T13:15:55.564+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): sync_producer_and_consumer> on 2024-12-09 13:15:44.651186+00:00
[2024-12-09T13:15:55.585+0000] {logging_mixin.py:190} WARNING - /home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=241) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-12-09T13:15:55.584+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'kafka_hive_pipeline_threaded', 'sync_producer_and_consumer', 'manual__2024-12-09T13:15:44.651186+00:00', '--job-id', '239', '--raw', '--subdir', 'DAGS_FOLDER/gestion_airflow.py', '--cfg-path', '/tmp/tmpts6v82w0']
[2024-12-09T13:15:55.590+0000] {standard_task_runner.py:105} INFO - Job 239: Subtask sync_producer_and_consumer
[2024-12-09T13:15:55.589+0000] {standard_task_runner.py:72} INFO - Started process 255 to run task
[2024-12-09T13:15:55.872+0000] {task_command.py:467} INFO - Running <TaskInstance: kafka_hive_pipeline_threaded.sync_producer_and_consumer manual__2024-12-09T13:15:44.651186+00:00 [running]> on host 45770b1a429e
[2024-12-09T13:15:56.220+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='kafka_hive_pipeline_threaded' AIRFLOW_CTX_TASK_ID='sync_producer_and_consumer' AIRFLOW_CTX_EXECUTION_DATE='2024-12-09T13:15:44.651186+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-12-09T13:15:44.651186+00:00'
[2024-12-09T13:15:56.224+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-09T13:15:56.645+0000] {csv_to_kafka_with_redis.py:51} INFO - Loaded CSV Data:
    Invoice ID Branch       City Customer type  Gender  ...      Payment    cogs  gross margin percentage  gross income  Rating
0  750-67-8428      A     Yangon        Member  Female  ...      Ewallet  522.83                 4.761905       26.1415     9.1
1  226-31-3081      C  Naypyitaw        Normal  Female  ...         Cash   76.40                 4.761905        3.8200     9.6
2  631-41-3108      A     Yangon        Normal    Male  ...  Credit card  324.31                 4.761905       16.2155     7.4
3  123-19-1176      A     Yangon        Member    Male  ...      Ewallet  465.76                 4.761905       23.2880     8.4
4  373-73-7910      A     Yangon        Normal    Male  ...      Ewallet  604.17                 4.761905       30.2085     5.3

[5 rows x 17 columns]
[2024-12-09T13:15:56.655+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '223e61d1-2b5a-4a28-94fe-34729b934457', 'invoice_id': '750-67-8428', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 74.69, 'quantity': 7, 'tax_5_percent': 26.1415, 'total': 548.9715, 'date': '1/5/2019', 'time': '13:08', 'payment': 'Ewallet', 'cogs': 522.83, 'gross_margin_percentage': 4.761904762, 'gross_income': 26.1415, 'rating': 9.1}
[2024-12-09T13:15:57.100+0000] {hive.py:475} INFO - USE `default`
[2024-12-09T13:15:59.031+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'f4eda24a-47d5-407a-9b91-bc4ac46ac219', 'invoice_id': '226-31-3081', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 15.28, 'quantity': 5, 'tax_5_percent': 3.82, 'total': 80.22, 'date': '3/8/2019', 'time': '10:29', 'payment': 'Cash', 'cogs': 76.4, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.82, 'rating': 9.6}
[2024-12-09T13:15:59.034+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'eba9b7a3-25a1-4be0-9dc7-06235a2822a4', 'invoice_id': '631-41-3108', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 46.33, 'quantity': 7, 'tax_5_percent': 16.2155, 'total': 340.5255, 'date': '3/3/2019', 'time': '13:23', 'payment': 'Credit card', 'cogs': 324.31, 'gross_margin_percentage': 4.761904762, 'gross_income': 16.2155, 'rating': 7.4}
[2024-12-09T13:15:59.036+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'f2964e50-574d-4ca5-b428-55c9878d6ce9', 'invoice_id': '123-19-1176', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 58.22, 'quantity': 8, 'tax_5_percent': 23.288, 'total': 489.048, 'date': '1/27/2019', 'time': '20:33', 'payment': 'Ewallet', 'cogs': 465.76, 'gross_margin_percentage': 4.761904762, 'gross_income': 23.288, 'rating': 8.4}
[2024-12-09T13:15:59.038+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '05601621-20ed-41f6-9c3e-d5b0406e58f9', 'invoice_id': '373-73-7910', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 86.31, 'quantity': 7, 'tax_5_percent': 30.2085, 'total': 634.3785, 'date': '2/8/2019', 'time': '10:37', 'payment': 'Ewallet', 'cogs': 604.17, 'gross_margin_percentage': 4.761904762, 'gross_income': 30.2085, 'rating': 5.3}
[2024-12-09T13:15:59.042+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'ff156e94-419a-44e0-a11e-708294366486', 'invoice_id': '699-14-3026', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 85.39, 'quantity': 7, 'tax_5_percent': 29.8865, 'total': 627.6165, 'date': '3/25/2019', 'time': '18:30', 'payment': 'Ewallet', 'cogs': 597.73, 'gross_margin_percentage': 4.761904762, 'gross_income': 29.8865, 'rating': 4.1}
[2024-12-09T13:15:59.046+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '0378bb94-aaf0-43db-975e-7109a2918958', 'invoice_id': '355-53-5943', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 68.84, 'quantity': 6, 'tax_5_percent': 20.652, 'total': 433.692, 'date': '2/25/2019', 'time': '14:36', 'payment': 'Ewallet', 'cogs': 413.04, 'gross_margin_percentage': 4.761904762, 'gross_income': 20.652, 'rating': 5.8}
[2024-12-09T13:15:59.049+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '955a466c-9bf9-4aff-9933-d40a1e0dc6ae', 'invoice_id': '315-22-5665', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 73.56, 'quantity': 10, 'tax_5_percent': 36.78, 'total': 772.38, 'date': '2/24/2019', 'time': '11:38', 'payment': 'Ewallet', 'cogs': 735.6, 'gross_margin_percentage': 4.761904762, 'gross_income': 36.78, 'rating': 8.0}
[2024-12-09T13:15:59.055+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'd3ebf6b7-a4e5-4b9d-8bb6-c0ebbc928918', 'invoice_id': '665-32-9167', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 36.26, 'quantity': 2, 'tax_5_percent': 3.626, 'total': 76.146, 'date': '1/10/2019', 'time': '17:15', 'payment': 'Credit card', 'cogs': 72.52, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.626, 'rating': 7.2}
[2024-12-09T13:15:59.062+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '212eb5dc-94ed-47f0-88b9-8867e0296f91', 'invoice_id': '692-92-5582', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 54.84, 'quantity': 3, 'tax_5_percent': 8.226, 'total': 172.746, 'date': '2/20/2019', 'time': '13:27', 'payment': 'Credit card', 'cogs': 164.52, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.226, 'rating': 5.9}
[2024-12-09T13:15:59.065+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'af7c22bb-dc60-4753-98c5-5474aaf02590', 'invoice_id': '351-62-0822', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 14.48, 'quantity': 4, 'tax_5_percent': 2.896, 'total': 60.816, 'date': '2/6/2019', 'time': '18:07', 'payment': 'Ewallet', 'cogs': 57.92, 'gross_margin_percentage': 4.761904762, 'gross_income': 2.896, 'rating': 4.5}
[2024-12-09T13:15:59.069+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '732c6eb8-9748-4c62-a618-fa833b9c3c8b', 'invoice_id': '529-56-3974', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 25.51, 'quantity': 4, 'tax_5_percent': 5.102, 'total': 107.142, 'date': '3/9/2019', 'time': '17:03', 'payment': 'Cash', 'cogs': 102.04, 'gross_margin_percentage': 4.761904762, 'gross_income': 5.102, 'rating': 6.8}
[2024-12-09T13:15:59.072+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '0ada8e4a-e1cf-4094-ae76-53b25391de86', 'invoice_id': '365-64-0515', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 46.95, 'quantity': 5, 'tax_5_percent': 11.7375, 'total': 246.4875, 'date': '2/12/2019', 'time': '10:25', 'payment': 'Ewallet', 'cogs': 234.75, 'gross_margin_percentage': 4.761904762, 'gross_income': 11.7375, 'rating': 7.1}
[2024-12-09T13:15:59.075+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'c310b29b-0950-462a-adac-b43f7f034bdb', 'invoice_id': '252-56-2699', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Food and beverages', 'unit_price': 43.19, 'quantity': 10, 'tax_5_percent': 21.595, 'total': 453.495, 'date': '2/7/2019', 'time': '16:48', 'payment': 'Ewallet', 'cogs': 431.9, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.595, 'rating': 8.2}
[2024-12-09T13:15:59.084+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'd631c57a-9bf0-49cd-b553-35a666ad5799', 'invoice_id': '829-34-3910', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 71.38, 'quantity': 10, 'tax_5_percent': 35.69, 'total': 749.49, 'date': '3/29/2019', 'time': '19:21', 'payment': 'Cash', 'cogs': 713.8, 'gross_margin_percentage': 4.761904762, 'gross_income': 35.69, 'rating': 5.7}
[2024-12-09T13:15:59.090+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '22835484-1fd1-4166-83ef-4f41561daa4a', 'invoice_id': '299-46-1805', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 93.72, 'quantity': 6, 'tax_5_percent': 28.116, 'total': 590.436, 'date': '1/15/2019', 'time': '16:19', 'payment': 'Cash', 'cogs': 562.32, 'gross_margin_percentage': 4.761904762, 'gross_income': 28.116, 'rating': 4.5}
[2024-12-09T13:15:59.096+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '96a8da45-ffa4-4b0f-8e55-0e7e08809efe', 'invoice_id': '656-95-9349', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 68.93, 'quantity': 7, 'tax_5_percent': 24.1255, 'total': 506.6355, 'date': '3/11/2019', 'time': '11:03', 'payment': 'Credit card', 'cogs': 482.51, 'gross_margin_percentage': 4.761904762, 'gross_income': 24.1255, 'rating': 4.6}
[2024-12-09T13:15:59.100+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '20e41b42-0903-46d2-b787-0ee8c8cc678d', 'invoice_id': '765-26-6951', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 72.61, 'quantity': 6, 'tax_5_percent': 21.783, 'total': 457.443, 'date': '1/1/2019', 'time': '10:39', 'payment': 'Credit card', 'cogs': 435.66, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.783, 'rating': 6.9}
[2024-12-09T13:15:59.103+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'f3269271-a45b-4be0-b013-8ac64bc58fde', 'invoice_id': '329-62-1586', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Food and beverages', 'unit_price': 54.67, 'quantity': 3, 'tax_5_percent': 8.2005, 'total': 172.2105, 'date': '1/21/2019', 'time': '18:00', 'payment': 'Credit card', 'cogs': 164.01, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.2005, 'rating': 8.6}
[2024-12-09T13:15:59.113+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'd996d0d4-c0b0-43b8-b723-dfa1c72b89fd', 'invoice_id': '319-50-3348', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 40.3, 'quantity': 2, 'tax_5_percent': 4.03, 'total': 84.63, 'date': '3/11/2019', 'time': '15:30', 'payment': 'Ewallet', 'cogs': 80.6, 'gross_margin_percentage': 4.761904762, 'gross_income': 4.03, 'rating': 4.4}
[2024-12-09T13:15:59.121+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '7c262f58-3fc6-44e3-82b8-aa68a01d050b', 'invoice_id': '300-71-4605', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 86.04, 'quantity': 5, 'tax_5_percent': 21.51, 'total': 451.71, 'date': '2/25/2019', 'time': '11:24', 'payment': 'Ewallet', 'cogs': 430.2, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.51, 'rating': 4.8}
[2024-12-09T13:15:59.125+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'f5b7c29e-e46a-4c22-bf6c-a66e20b4e88e', 'invoice_id': '371-85-5789', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 87.98, 'quantity': 3, 'tax_5_percent': 13.197, 'total': 277.137, 'date': '3/5/2019', 'time': '10:40', 'payment': 'Ewallet', 'cogs': 263.94, 'gross_margin_percentage': 4.761904762, 'gross_income': 13.197, 'rating': 5.1}
[2024-12-09T13:15:59.135+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'c9480270-36e0-474f-8df1-55f08d3a6704', 'invoice_id': '273-16-6619', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 33.2, 'quantity': 2, 'tax_5_percent': 3.32, 'total': 69.72, 'date': '3/15/2019', 'time': '12:20', 'payment': 'Credit card', 'cogs': 66.4, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.32, 'rating': 4.4}
[2024-12-09T13:15:59.138+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'e7af309b-caae-4371-ba48-21b41ebd9450', 'invoice_id': '636-48-8204', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 34.56, 'quantity': 5, 'tax_5_percent': 8.64, 'total': 181.44, 'date': '2/17/2019', 'time': '11:15', 'payment': 'Ewallet', 'cogs': 172.8, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.64, 'rating': 9.9}
[2024-12-09T13:15:59.141+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'de8c0807-2b9e-4ab6-a057-44505ba81818', 'invoice_id': '549-59-1358', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 88.63, 'quantity': 3, 'tax_5_percent': 13.2945, 'total': 279.1845, 'date': '3/2/2019', 'time': '17:36', 'payment': 'Ewallet', 'cogs': 265.89, 'gross_margin_percentage': 4.761904762, 'gross_income': 13.2945, 'rating': 6.0}
[2024-12-09T13:15:59.156+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '30b796b7-3ca9-4102-bba6-1a2f188b70f5', 'invoice_id': '227-03-5010', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 52.59, 'quantity': 8, 'tax_5_percent': 21.036, 'total': 441.756, 'date': '3/22/2019', 'time': '19:20', 'payment': 'Credit card', 'cogs': 420.72, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.036, 'rating': 8.5}
[2024-12-09T13:15:59.166+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '4b2ba756-b414-4258-85a9-ceb97bc8d85b', 'invoice_id': '649-29-6775', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Fashion accessories', 'unit_price': 33.52, 'quantity': 1, 'tax_5_percent': 1.676, 'total': 35.196, 'date': '2/8/2019', 'time': '15:31', 'payment': 'Cash', 'cogs': 33.52, 'gross_margin_percentage': 4.761904762, 'gross_income': 1.676, 'rating': 6.7}
[2024-12-09T13:15:59.173+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '4626fe96-5f0b-45a2-9ce5-c707d14aed3a', 'invoice_id': '189-17-4241', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 87.67, 'quantity': 2, 'tax_5_percent': 8.767, 'total': 184.107, 'date': '3/10/2019', 'time': '12:17', 'payment': 'Credit card', 'cogs': 175.34, 'gross_margin_percentage': 4.761904762, 'gross_income': 8.767, 'rating': 7.7}
[2024-12-09T13:15:59.179+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '843f5069-6231-44c2-bf11-d0ea0821b587', 'invoice_id': '145-94-9061', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 88.36, 'quantity': 5, 'tax_5_percent': 22.09, 'total': 463.89, 'date': '1/25/2019', 'time': '19:48', 'payment': 'Cash', 'cogs': 441.8, 'gross_margin_percentage': 4.761904762, 'gross_income': 22.09, 'rating': 9.6}
[2024-12-09T13:15:59.185+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'f2ebef19-640f-4274-b293-dc38da9aaca1', 'invoice_id': '848-62-7243', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 24.89, 'quantity': 9, 'tax_5_percent': 11.2005, 'total': 235.2105, 'date': '3/15/2019', 'time': '15:36', 'payment': 'Cash', 'cogs': 224.01, 'gross_margin_percentage': 4.761904762, 'gross_income': 11.2005, 'rating': 7.4}
[2024-12-09T13:15:59.188+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '906c27e7-56a6-4521-b06c-535c161f65fd', 'invoice_id': '871-79-8483', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Fashion accessories', 'unit_price': 94.13, 'quantity': 5, 'tax_5_percent': 23.5325, 'total': 494.1825, 'date': '2/25/2019', 'time': '19:39', 'payment': 'Credit card', 'cogs': 470.65, 'gross_margin_percentage': 4.761904762, 'gross_income': 23.5325, 'rating': 4.8}
[2024-12-09T13:15:59.199+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '236b2644-43d5-4b43-b930-96e284733c8a', 'invoice_id': '149-71-6266', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 78.07, 'quantity': 9, 'tax_5_percent': 35.1315, 'total': 737.7615, 'date': '1/28/2019', 'time': '12:43', 'payment': 'Cash', 'cogs': 702.63, 'gross_margin_percentage': 4.761904762, 'gross_income': 35.1315, 'rating': 4.5}
[2024-12-09T13:15:59.207+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '2078ab8f-f473-4190-a1c9-85ed543cfb6e', 'invoice_id': '640-49-2076', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 83.78, 'quantity': 8, 'tax_5_percent': 33.512, 'total': 703.752, 'date': '1/10/2019', 'time': '14:49', 'payment': 'Cash', 'cogs': 670.24, 'gross_margin_percentage': 4.761904762, 'gross_income': 33.512, 'rating': 5.1}
[2024-12-09T13:15:59.215+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '61e77b3d-81e1-4473-9e4f-0446ac560e8d', 'invoice_id': '595-11-5460', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 96.58, 'quantity': 2, 'tax_5_percent': 9.658, 'total': 202.818, 'date': '3/15/2019', 'time': '10:12', 'payment': 'Credit card', 'cogs': 193.16, 'gross_margin_percentage': 4.761904762, 'gross_income': 9.658, 'rating': 5.1}
[2024-12-09T13:15:59.219+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '11d2c956-36cc-4e20-83df-be0a3c1c791b', 'invoice_id': '183-56-6882', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 99.42, 'quantity': 4, 'tax_5_percent': 19.884, 'total': 417.564, 'date': '2/6/2019', 'time': '10:42', 'payment': 'Ewallet', 'cogs': 397.68, 'gross_margin_percentage': 4.761904762, 'gross_income': 19.884, 'rating': 7.5}
[2024-12-09T13:15:59.235+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '8e7f88e0-e3a6-4268-8f09-1dc43d795560', 'invoice_id': '232-16-2483', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 68.12, 'quantity': 1, 'tax_5_percent': 3.406, 'total': 71.526, 'date': '1/7/2019', 'time': '12:28', 'payment': 'Ewallet', 'cogs': 68.12, 'gross_margin_percentage': 4.761904762, 'gross_income': 3.406, 'rating': 6.8}
[2024-12-09T13:15:59.238+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '251b67a7-084d-4ccd-9fd7-022a0d798ec9', 'invoice_id': '129-29-8530', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 62.62, 'quantity': 5, 'tax_5_percent': 15.655, 'total': 328.755, 'date': '3/10/2019', 'time': '19:15', 'payment': 'Ewallet', 'cogs': 313.1, 'gross_margin_percentage': 4.761904762, 'gross_income': 15.655, 'rating': 7.0}
[2024-12-09T13:15:59.251+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'c13aeaad-a26a-428e-b64e-f48b8d2384c5', 'invoice_id': '272-65-1806', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 60.88, 'quantity': 9, 'tax_5_percent': 27.396, 'total': 575.316, 'date': '1/15/2019', 'time': '17:17', 'payment': 'Ewallet', 'cogs': 547.92, 'gross_margin_percentage': 4.761904762, 'gross_income': 27.396, 'rating': 4.7}
[2024-12-09T13:15:59.255+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'd28787b5-7d21-4121-b7b1-6a859d235a3f', 'invoice_id': '333-73-7901', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 54.92, 'quantity': 8, 'tax_5_percent': 21.968, 'total': 461.328, 'date': '3/23/2019', 'time': '13:24', 'payment': 'Ewallet', 'cogs': 439.36, 'gross_margin_percentage': 4.761904762, 'gross_income': 21.968, 'rating': 7.6}
[2024-12-09T13:15:59.258+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '2561d54d-139c-475b-ad38-d187e1f4c113', 'invoice_id': '777-82-7220', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 30.12, 'quantity': 8, 'tax_5_percent': 12.048, 'total': 253.008, 'date': '3/3/2019', 'time': '13:01', 'payment': 'Cash', 'cogs': 240.96, 'gross_margin_percentage': 4.761904762, 'gross_income': 12.048, 'rating': 7.7}
[2024-12-09T13:15:59.264+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '88847486-2c8e-4ee0-8e2c-19685c1f7745', 'invoice_id': '280-35-5823', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 86.72, 'quantity': 1, 'tax_5_percent': 4.336, 'total': 91.056, 'date': '1/17/2019', 'time': '18:45', 'payment': 'Ewallet', 'cogs': 86.72, 'gross_margin_percentage': 4.761904762, 'gross_income': 4.336, 'rating': 7.9}
[2024-12-09T13:15:59.271+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'e956a56e-f840-4327-ae73-a840ccf26bfc', 'invoice_id': '554-53-8700', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 56.11, 'quantity': 2, 'tax_5_percent': 5.611, 'total': 117.831, 'date': '2/2/2019', 'time': '10:11', 'payment': 'Cash', 'cogs': 112.22, 'gross_margin_percentage': 4.761904762, 'gross_income': 5.611, 'rating': 6.3}
[2024-12-09T13:15:59.281+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '62037e74-a0ee-405d-908c-3cd2c496dcd4', 'invoice_id': '354-25-5821', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 69.12, 'quantity': 6, 'tax_5_percent': 20.736, 'total': 435.456, 'date': '2/8/2019', 'time': '13:03', 'payment': 'Cash', 'cogs': 414.72, 'gross_margin_percentage': 4.761904762, 'gross_income': 20.736, 'rating': 5.6}
[2024-12-09T13:15:59.286+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'f4d83e84-df1c-4fd3-94eb-9549e17ae0e1', 'invoice_id': '228-96-1411', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 98.7, 'quantity': 8, 'tax_5_percent': 39.48, 'total': 829.08, 'date': '3/4/2019', 'time': '20:39', 'payment': 'Cash', 'cogs': 789.6, 'gross_margin_percentage': 4.761904762, 'gross_income': 39.48, 'rating': 7.6}
[2024-12-09T13:15:59.294+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '56ace7f9-01c2-4249-bfcd-3ea939ad800e', 'invoice_id': '617-15-4209', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 15.37, 'quantity': 2, 'tax_5_percent': 1.537, 'total': 32.277, 'date': '3/16/2019', 'time': '19:47', 'payment': 'Cash', 'cogs': 30.74, 'gross_margin_percentage': 4.761904762, 'gross_income': 1.537, 'rating': 7.2}
[2024-12-09T13:15:59.302+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': 'a2f4c621-6e32-492a-b109-d43fe0787948', 'invoice_id': '132-32-9879', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 93.96, 'quantity': 4, 'tax_5_percent': 18.792, 'total': 394.632, 'date': '3/9/2019', 'time': '18:00', 'payment': 'Cash', 'cogs': 375.84, 'gross_margin_percentage': 4.761904762, 'gross_income': 18.792, 'rating': 9.5}
[2024-12-09T13:15:59.305+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '092e0c88-6e32-4196-b248-9dbe12dd149e', 'invoice_id': '370-41-7321', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 56.69, 'quantity': 9, 'tax_5_percent': 25.5105, 'total': 535.7205, 'date': '2/27/2019', 'time': '17:24', 'payment': 'Credit card', 'cogs': 510.21, 'gross_margin_percentage': 4.761904762, 'gross_income': 25.5105, 'rating': 8.4}
[2024-12-09T13:15:59.311+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '791b8d29-f430-4ffa-90cf-8ae9f6558271', 'invoice_id': '727-46-3608', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 20.01, 'quantity': 9, 'tax_5_percent': 9.0045, 'total': 189.0945, 'date': '2/6/2019', 'time': '15:47', 'payment': 'Ewallet', 'cogs': 180.09, 'gross_margin_percentage': 4.761904762, 'gross_income': 9.0045, 'rating': 4.1}
[2024-12-09T13:15:59.317+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '172c0baa-86f3-4e3d-a1d8-29070b3f9ca7', 'invoice_id': '669-54-1719', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 18.93, 'quantity': 6, 'tax_5_percent': 5.679, 'total': 119.259, 'date': '2/10/2019', 'time': '12:45', 'payment': 'Credit card', 'cogs': 113.58, 'gross_margin_percentage': 4.761904762, 'gross_income': 5.679, 'rating': 8.1}
[2024-12-09T13:15:59.325+0000] {csv_to_kafka_with_redis.py:85} INFO - Row data before serialization: {'id': '90c49395-31e5-42cf-9db9-880ae3883bc7', 'invoice_id': '574-22-5561', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 82.63, 'quantity': 10, 'tax_5_percent': 41.315, 'total': 867.615, 'date': '3/19/2019', 'time': '17:08', 'payment': 'Ewallet', 'cogs': 826.3, 'gross_margin_percentage': 4.761904762, 'gross_income': 41.315, 'rating': 7.9}
[2024-12-09T13:15:59.374+0000] {csv_to_kafka_with_redis.py:95} INFO - Batch 1 envoyé à Kafka.
[2024-12-09T13:16:00.103+0000] {hive.py:475} INFO - 
    CREATE TABLE IF NOT EXISTS sales (
        id STRING,
        invoice_id STRING,
        branch STRING,
        city STRING,
        customer_type STRING,
        gender STRING,
        product_line STRING,
        unit_price FLOAT,
        quantity INT,
        tax_5_percent FLOAT,
        total FLOAT,
        `date` STRING,
        time STRING,
        payment STRING,
        cogs FLOAT,
        gross_margin_percentage FLOAT,
        gross_income FLOAT,
        rating FLOAT
    ) STORED AS ORC
    
[2024-12-09T13:16:00.437+0000] {kafka_to_hive_with_redis.py:75} INFO - Topic 'batch-topic' exists with 1 partitions.
[2024-12-09T13:16:00.545+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hc0410f6c-ba77-4563-a5cf-0906c46a9358\x16750-67-8428\x02A\x0cYangon\x0cMember\x0cFemale"Health and beautyHa\x95B\x0e\xcb!\xd1A->\tD\x101/5/2019\n13:08\x0eEwallet\x1f\xb5\x02D\x86a\x98@\xcb!\xd1A\x9a\x99\x11A'
[2024-12-09T13:16:00.548+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'c0410f6c-ba77-4563-a5cf-0906c46a9358', 'invoice_id': '750-67-8428', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 74.69000244140625, 'quantity': 7, 'tax_5_percent': 26.14150047302246, 'total': 548.9714965820312, 'date': '1/5/2019', 'time': '13:08', 'payment': 'Ewallet', 'cogs': 522.8300170898438, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 26.14150047302246, 'rating': 9.100000381469727}
[2024-12-09T13:16:00.550+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hd502b072-f0f0-40f8-8048-de7b333c1d3d\x16226-31-3081\x02C\x12Naypyitaw\x0cNormal\x0cFemale,Electronic accessories\xe1ztA\n\xe1zt@\xa4p\xa0B\x103/8/2019\n10:29\x08Cash\xcd\xcc\x98B\x86a\x98@\xe1zt@\x9a\x99\x19A'
[2024-12-09T13:16:00.553+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'd502b072-f0f0-40f8-8048-de7b333c1d3d', 'invoice_id': '226-31-3081', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 15.279999732971191, 'quantity': 5, 'tax_5_percent': 3.819999933242798, 'total': 80.22000122070312, 'date': '3/8/2019', 'time': '10:29', 'payment': 'Cash', 'cogs': 76.4000015258789, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 3.819999933242798, 'rating': 9.600000381469727}
[2024-12-09T13:16:00.554+0000] {logging_mixin.py:190} INFO - b"\x00\x00\x00\x00\x03H745c180f-81c8-4c38-a0c4-db9bc86c43e8\x16631-41-3108\x02A\x0cYangon\x0cNormal\x08Male$Home and lifestyle\xecQ9B\x0eX\xb9\x81ADC\xaaC\x103/3/2019\n13:23\x16Credit card\xae'\xa2C\x86a\x98@X\xb9\x81A\xcd\xcc\xec@"
[2024-12-09T13:16:00.556+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '745c180f-81c8-4c38-a0c4-db9bc86c43e8', 'invoice_id': '631-41-3108', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 46.33000183105469, 'quantity': 7, 'tax_5_percent': 16.215499877929688, 'total': 340.5255126953125, 'date': '3/3/2019', 'time': '13:23', 'payment': 'Credit card', 'cogs': 324.30999755859375, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 16.215499877929688, 'rating': 7.400000095367432}
[2024-12-09T13:16:00.558+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hc2943ea2-2e23-4eea-82d7-be55ff4c6279\x16123-19-1176\x02A\x0cYangon\x0cMember\x08Male"Health and beautyH\xe1hB\x10\xd3M\xbaA%\x86\xf4C\x121/27/2019\n20:33\x0eEwalletH\xe1\xe8C\x86a\x98@\xd3M\xbaAff\x06A'
[2024-12-09T13:16:00.562+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'c2943ea2-2e23-4eea-82d7-be55ff4c6279', 'invoice_id': '123-19-1176', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 58.220001220703125, 'quantity': 8, 'tax_5_percent': 23.288000106811523, 'total': 489.0480041503906, 'date': '1/27/2019', 'time': '20:33', 'payment': 'Ewallet', 'cogs': 465.760009765625, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 23.288000106811523, 'rating': 8.399999618530273}
[2024-12-09T13:16:00.565+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H4faeac6d-c7ed-4cfd-9a40-877e70cf6256\x16373-73-7910\x02A\x0cYangon\x0cNormal\x08Male"Sports and travel\xb8\x9e\xacB\x0e\x02\xab\xf1A9\x98\x1eD\x102/8/2019\n10:37\x0eEwallet\xe1\n\x17D\x86a\x98@\x02\xab\xf1A\x9a\x99\xa9@'
[2024-12-09T13:16:00.567+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '4faeac6d-c7ed-4cfd-9a40-877e70cf6256', 'invoice_id': '373-73-7910', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 86.30999755859375, 'quantity': 7, 'tax_5_percent': 30.208499908447266, 'total': 634.3784790039062, 'date': '2/8/2019', 'time': '10:37', 'payment': 'Ewallet', 'cogs': 604.1699829101562, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 30.208499908447266, 'rating': 5.300000190734863}
[2024-12-09T13:16:00.568+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H464bed22-4311-4f11-8af9-e9e0bfa8b0fd\x16699-14-3026\x02C\x12Naypyitaw\x0cNormal\x08Male,Electronic accessories\xae\xc7\xaaB\x0e\x8d\x17\xefAu\xe7\x1cD\x123/25/2019\n18:30\x0eEwallet\xb8n\x15D\x86a\x98@\x8d\x17\xefA33\x83@'
[2024-12-09T13:16:00.570+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '464bed22-4311-4f11-8af9-e9e0bfa8b0fd', 'invoice_id': '699-14-3026', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 85.38999938964844, 'quantity': 7, 'tax_5_percent': 29.886499404907227, 'total': 627.6165161132812, 'date': '3/25/2019', 'time': '18:30', 'payment': 'Ewallet', 'cogs': 597.72998046875, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 29.886499404907227, 'rating': 4.099999904632568}
[2024-12-09T13:16:00.572+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Ha86b2bdd-261b-41e7-9fef-b6f869c3291b\x16355-53-5943\x02A\x0cYangon\x0cMember\x0cFemale,Electronic accessories\x14\xae\x89B\x0cL7\xa5A\x93\xd8\xd8C\x122/25/2019\n14:36\x0eEwallet\x1f\x85\xceC\x86a\x98@L7\xa5A\x9a\x99\xb9@'
[2024-12-09T13:16:00.574+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'a86b2bdd-261b-41e7-9fef-b6f869c3291b', 'invoice_id': '355-53-5943', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 68.83999633789062, 'quantity': 6, 'tax_5_percent': 20.652000427246094, 'total': 433.6919860839844, 'date': '2/25/2019', 'time': '14:36', 'payment': 'Ewallet', 'cogs': 413.0400085449219, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 20.652000427246094, 'rating': 5.800000190734863}
[2024-12-09T13:16:00.576+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H26673db7-f051-4d03-b64d-62929c74dae4\x16315-22-5665\x02C\x12Naypyitaw\x0cNormal\x0cFemale$Home and lifestyle\xb8\x1e\x93B\x14\xb8\x1e\x13BR\x18AD\x122/24/2019\n11:38\x0eEwalletf\xe67D\x86a\x98@\xb8\x1e\x13B\x00\x00\x00A'
[2024-12-09T13:16:00.583+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '26673db7-f051-4d03-b64d-62929c74dae4', 'invoice_id': '315-22-5665', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 73.55999755859375, 'quantity': 10, 'tax_5_percent': 36.779998779296875, 'total': 772.3800048828125, 'date': '2/24/2019', 'time': '11:38', 'payment': 'Ewallet', 'cogs': 735.5999755859375, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 36.779998779296875, 'rating': 8.0}
[2024-12-09T13:16:00.586+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H37492b1b-e4a7-440e-896b-dc25164901af\x16665-32-9167\x02A\x0cYangon\x0cMember\x0cFemale"Health and beauty=\n\x11B\x04b\x10h@\xc1J\x98B\x121/10/2019\n17:15\x16Credit card=\n\x91B\x86a\x98@b\x10h@ff\xe6@'
[2024-12-09T13:16:00.588+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '37492b1b-e4a7-440e-896b-dc25164901af', 'invoice_id': '665-32-9167', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 36.2599983215332, 'quantity': 2, 'tax_5_percent': 3.625999927520752, 'total': 76.14600372314453, 'date': '1/10/2019', 'time': '17:15', 'payment': 'Credit card', 'cogs': 72.5199966430664, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 3.625999927520752, 'rating': 7.199999809265137}
[2024-12-09T13:16:00.590+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hb01e70ba-9e53-4b67-b4ea-93e21151b202\x16692-92-5582\x02B\x10Mandalay\x0cMember\x0cFemale$Food and beverages)\\[B\x06\xb2\x9d\x03A\xfa\xbe,C\x122/20/2019\n13:27\x16Credit card\x1f\x85$C\x86a\x98@\xb2\x9d\x03A\xcd\xcc\xbc@'
[2024-12-09T13:16:00.594+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'b01e70ba-9e53-4b67-b4ea-93e21151b202', 'invoice_id': '692-92-5582', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 54.84000015258789, 'quantity': 3, 'tax_5_percent': 8.22599983215332, 'total': 172.74600219726562, 'date': '2/20/2019', 'time': '13:27', 'payment': 'Credit card', 'cogs': 164.52000427246094, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 8.22599983215332, 'rating': 5.900000095367432}
[2024-12-09T13:16:00.596+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H3d079f09-69f8-4aa5-bc46-75663aed8f91\x16351-62-0822\x02B\x10Mandalay\x0cMember\x0cFemale&Fashion accessories\x14\xaegA\x08\x10X9@\x96CsB\x102/6/2019\n18:07\x0eEwallet\x14\xaegB\x86a\x98@\x10X9@\x00\x00\x90@'
[2024-12-09T13:16:00.598+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '3d079f09-69f8-4aa5-bc46-75663aed8f91', 'invoice_id': '351-62-0822', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 14.479999542236328, 'quantity': 4, 'tax_5_percent': 2.8959999084472656, 'total': 60.816001892089844, 'date': '2/6/2019', 'time': '18:07', 'payment': 'Ewallet', 'cogs': 57.91999816894531, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 2.8959999084472656, 'rating': 4.5}
[2024-12-09T13:16:00.600+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H0766b322-ebef-409a-ba29-9a539649b5d7\x16529-56-3974\x02B\x10Mandalay\x0cMember\x08Male,Electronic accessories{\x14\xccA\x08\x96C\xa3@\xb4H\xd6B\x103/9/2019\n17:03\x08Cash{\x14\xccB\x86a\x98@\x96C\xa3@\x9a\x99\xd9@'
[2024-12-09T13:16:00.602+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '0766b322-ebef-409a-ba29-9a539649b5d7', 'invoice_id': '529-56-3974', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 25.510000228881836, 'quantity': 4, 'tax_5_percent': 5.1020002365112305, 'total': 107.14199829101562, 'date': '3/9/2019', 'time': '17:03', 'payment': 'Cash', 'cogs': 102.04000091552734, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 5.1020002365112305, 'rating': 6.800000190734863}
[2024-12-09T13:16:00.604+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hd4bd851d-9537-49cf-90d9-5f1f663e44ec\x16365-64-0515\x02A\x0cYangon\x0cNormal\x0cFemale,Electronic accessories\xcd\xcc;B\n\xcd\xcc;A\xcd|vC\x122/12/2019\n10:25\x0eEwallet\x00\xc0jC\x86a\x98@\xcd\xcc;A33\xe3@'
[2024-12-09T13:16:00.606+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'd4bd851d-9537-49cf-90d9-5f1f663e44ec', 'invoice_id': '365-64-0515', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 46.95000076293945, 'quantity': 5, 'tax_5_percent': 11.737500190734863, 'total': 246.4875030517578, 'date': '2/12/2019', 'time': '10:25', 'payment': 'Ewallet', 'cogs': 234.75, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 11.737500190734863, 'rating': 7.099999904632568}
[2024-12-09T13:16:00.607+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hdfe15ddb-96dd-4df1-bbf2-92b4985c7a9b\x16252-56-2699\x02A\x0cYangon\x0cNormal\x08Male$Food and beverages\x8f\xc2,B\x14\x8f\xc2\xacA\\\xbf\xe2C\x102/7/2019\n16:48\x0eEwallet3\xf3\xd7C\x86a\x98@\x8f\xc2\xacA33\x03A'
[2024-12-09T13:16:00.610+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'dfe15ddb-96dd-4df1-bbf2-92b4985c7a9b', 'invoice_id': '252-56-2699', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Food and beverages', 'unit_price': 43.189998626708984, 'quantity': 10, 'tax_5_percent': 21.594999313354492, 'total': 453.4949951171875, 'date': '2/7/2019', 'time': '16:48', 'payment': 'Ewallet', 'cogs': 431.8999938964844, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 21.594999313354492, 'rating': 8.199999809265137}
[2024-12-09T13:16:00.614+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H77c3aeff-cbe0-4ec1-b338-29ee01ba1905\x16829-34-3910\x02A\x0cYangon\x0cNormal\x0cFemale"Health and beauty\x8f\xc2\x8eB\x14\x8f\xc2\x0eB\\_;D\x123/29/2019\n19:21\x08Cash3s2D\x86a\x98@\x8f\xc2\x0eBff\xb6@'
[2024-12-09T13:16:00.616+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '77c3aeff-cbe0-4ec1-b338-29ee01ba1905', 'invoice_id': '829-34-3910', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 71.37999725341797, 'quantity': 10, 'tax_5_percent': 35.689998626708984, 'total': 749.489990234375, 'date': '3/29/2019', 'time': '19:21', 'payment': 'Cash', 'cogs': 713.7999877929688, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 35.689998626708984, 'rating': 5.699999809265137}
[2024-12-09T13:16:00.618+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H58f47858-b827-45be-8077-5288f7358ca9\x16299-46-1805\x02B\x10Mandalay\x0cMember\x0cFemale"Sports and travel\xa4p\xbbB\x0c\x91\xed\xe0A\xe7\x9b\x13D\x121/15/2019\n16:19\x08Cash{\x94\x0cD\x86a\x98@\x91\xed\xe0A\x00\x00\x90@'
[2024-12-09T13:16:00.621+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '58f47858-b827-45be-8077-5288f7358ca9', 'invoice_id': '299-46-1805', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 93.72000122070312, 'quantity': 6, 'tax_5_percent': 28.115999221801758, 'total': 590.4359741210938, 'date': '1/15/2019', 'time': '16:19', 'payment': 'Cash', 'cogs': 562.3200073242188, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 28.115999221801758, 'rating': 4.5}
[2024-12-09T13:16:00.623+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H148618f0-ebf8-43e6-9397-2b8e8b2fe319\x16656-95-9349\x02A\x0cYangon\x0cMember\x0cFemale"Health and beauty)\xdc\x89B\x0e\x06\x01\xc1AXQ\xfdC\x123/11/2019\n11:03\x16Credit cardHA\xf1C\x86a\x98@\x06\x01\xc1A33\x93@'
[2024-12-09T13:16:00.624+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '148618f0-ebf8-43e6-9397-2b8e8b2fe319', 'invoice_id': '656-95-9349', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 68.93000030517578, 'quantity': 7, 'tax_5_percent': 24.125499725341797, 'total': 506.635498046875, 'date': '3/11/2019', 'time': '11:03', 'payment': 'Credit card', 'cogs': 482.510009765625, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 24.125499725341797, 'rating': 4.599999904632568}
[2024-12-09T13:16:00.628+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hf9656a9d-5162-4f7c-9116-6d0d5c325816\x16765-26-6951\x02A\x0cYangon\x0cNormal\x08Male"Sports and travelR8\x91B\x0c\x96C\xaeA\xb4\xb8\xe4C\x101/1/2019\n10:39\x16Credit card{\xd4\xd9C\x86a\x98@\x96C\xaeA\xcd\xcc\xdc@'
[2024-12-09T13:16:00.634+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'f9656a9d-5162-4f7c-9116-6d0d5c325816', 'invoice_id': '765-26-6951', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 72.61000061035156, 'quantity': 6, 'tax_5_percent': 21.783000946044922, 'total': 457.4429931640625, 'date': '1/1/2019', 'time': '10:39', 'payment': 'Credit card', 'cogs': 435.6600036621094, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 21.783000946044922, 'rating': 6.900000095367432}
[2024-12-09T13:16:00.636+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H2adcf19a-8f0e-4fd9-a9a2-b66551e49065\x16329-62-1586\x02A\x0cYangon\x0cNormal\x08Male$Food and beverages\x14\xaeZB\x06?5\x03A\xe35,C\x121/21/2019\n18:00\x16Credit card\x8f\x02$C\x86a\x98@?5\x03A\x9a\x99\tA'
[2024-12-09T13:16:00.639+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '2adcf19a-8f0e-4fd9-a9a2-b66551e49065', 'invoice_id': '329-62-1586', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Food and beverages', 'unit_price': 54.66999816894531, 'quantity': 3, 'tax_5_percent': 8.200499534606934, 'total': 172.2104949951172, 'date': '1/21/2019', 'time': '18:00', 'payment': 'Credit card', 'cogs': 164.00999450683594, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 8.200499534606934, 'rating': 8.600000381469727}
[2024-12-09T13:16:00.640+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hc4df17ab-0544-4b69-8865-007dbec9b6a6\x16319-50-3348\x02B\x10Mandalay\x0cNormal\x0cFemale$Home and lifestyle33!B\x04\xc3\xf5\x80@\x8fB\xa9B\x123/11/2019\n15:30\x0eEwallet33\xa1B\x86a\x98@\xc3\xf5\x80@\xcd\xcc\x8c@'
[2024-12-09T13:16:00.641+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'c4df17ab-0544-4b69-8865-007dbec9b6a6', 'invoice_id': '319-50-3348', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 40.29999923706055, 'quantity': 2, 'tax_5_percent': 4.03000020980835, 'total': 84.62999725341797, 'date': '3/11/2019', 'time': '15:30', 'payment': 'Ewallet', 'cogs': 80.5999984741211, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 4.03000020980835, 'rating': 4.400000095367432}
[2024-12-09T13:16:00.644+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hb058895f-1eb2-4f00-97d6-a14c8e424ba2\x16300-71-4605\x02C\x12Naypyitaw\x0cMember\x08Male,Electronic accessories{\x14\xacB\n{\x14\xacA\xe1\xda\xe1C\x122/25/2019\n11:24\x0eEwallet\x9a\x19\xd7C\x86a\x98@{\x14\xacA\x9a\x99\x99@'
[2024-12-09T13:16:00.646+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'b058895f-1eb2-4f00-97d6-a14c8e424ba2', 'invoice_id': '300-71-4605', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 86.04000091552734, 'quantity': 5, 'tax_5_percent': 21.510000228881836, 'total': 451.7099914550781, 'date': '2/25/2019', 'time': '11:24', 'payment': 'Ewallet', 'cogs': 430.20001220703125, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 21.510000228881836, 'rating': 4.800000190734863}
[2024-12-09T13:16:00.649+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Ha694abfe-6ce4-4974-990f-a069998691f7\x16371-85-5789\x02B\x10Mandalay\x0cNormal\x08Male"Health and beauty\xc3\xf5\xafB\x06\xe9&SA\x89\x91\x8aC\x103/5/2019\n10:40\x0eEwalletR\xf8\x83C\x86a\x98@\xe9&SA33\xa3@'
[2024-12-09T13:16:00.652+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'a694abfe-6ce4-4974-990f-a069998691f7', 'invoice_id': '371-85-5789', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 87.9800033569336, 'quantity': 3, 'tax_5_percent': 13.196999549865723, 'total': 277.1369934082031, 'date': '3/5/2019', 'time': '10:40', 'payment': 'Ewallet', 'cogs': 263.94000244140625, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 13.196999549865723, 'rating': 5.099999904632568}
[2024-12-09T13:16:00.653+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H6515077a-3049-4b72-819e-0c5a6227448e\x16273-16-6619\x02B\x10Mandalay\x0cNormal\x08Male$Home and lifestyle\xcd\xcc\x04B\x04\xe1zT@\xa4p\x8bB\x123/15/2019\n12:20\x16Credit card\xcd\xcc\x84B\x86a\x98@\xe1zT@\xcd\xcc\x8c@'
[2024-12-09T13:16:00.679+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '6515077a-3049-4b72-819e-0c5a6227448e', 'invoice_id': '273-16-6619', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 33.20000076293945, 'quantity': 2, 'tax_5_percent': 3.319999933242798, 'total': 69.72000122070312, 'date': '3/15/2019', 'time': '12:20', 'payment': 'Credit card', 'cogs': 66.4000015258789, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 3.319999933242798, 'rating': 4.400000095367432}
[2024-12-09T13:16:00.681+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H62daf8cf-6c9b-4841-aeac-4e4363448ba2\x16636-48-8204\x02A\x0cYangon\x0cNormal\x08Male,Electronic accessoriesq=\nB\nq=\nA\xa4p5C\x122/17/2019\n11:15\x0eEwallet\xcd\xcc,C\x86a\x98@q=\nAff\x1eA'
[2024-12-09T13:16:00.683+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '62daf8cf-6c9b-4841-aeac-4e4363448ba2', 'invoice_id': '636-48-8204', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 34.560001373291016, 'quantity': 5, 'tax_5_percent': 8.640000343322754, 'total': 181.44000244140625, 'date': '2/17/2019', 'time': '11:15', 'payment': 'Ewallet', 'cogs': 172.8000030517578, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 8.640000343322754, 'rating': 9.899999618530273}
[2024-12-09T13:16:00.684+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H60ebbc3c-11dd-48e6-b94a-31400228c55e\x16549-59-1358\x02A\x0cYangon\x0cMember\x08Male"Sports and travel\x8fB\xb1B\x06F\xb6TA\x9e\x97\x8bC\x103/2/2019\n17:36\x0eEwallet\xec\xf1\x84C\x86a\x98@F\xb6TA\x00\x00\xc0@'
[2024-12-09T13:16:00.686+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '60ebbc3c-11dd-48e6-b94a-31400228c55e', 'invoice_id': '549-59-1358', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 88.62999725341797, 'quantity': 3, 'tax_5_percent': 13.294500350952148, 'total': 279.18450927734375, 'date': '3/2/2019', 'time': '17:36', 'payment': 'Ewallet', 'cogs': 265.8900146484375, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 13.294500350952148, 'rating': 6.0}
[2024-12-09T13:16:00.688+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Ha29a576f-5f78-4a0c-a417-ffdacd9e8752\x16227-03-5010\x02A\x0cYangon\x0cMember\x0cFemale$Home and lifestyle)\\RB\x10\xbaI\xa8A\xc5\xe0\xdcC\x123/22/2019\n19:20\x16Credit card)\\\xd2C\x86a\x98@\xbaI\xa8A\x00\x00\x08A'
[2024-12-09T13:16:00.690+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'a29a576f-5f78-4a0c-a417-ffdacd9e8752', 'invoice_id': '227-03-5010', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 52.59000015258789, 'quantity': 8, 'tax_5_percent': 21.035999298095703, 'total': 441.7560119628906, 'date': '3/22/2019', 'time': '19:20', 'payment': 'Credit card', 'cogs': 420.7200012207031, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 21.035999298095703, 'rating': 8.5}
[2024-12-09T13:16:00.691+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H88b47b70-b01f-462f-8b04-b395708ed576\x16649-29-6775\x02B\x10Mandalay\x0cNormal\x08Male&Fashion accessories{\x14\x06B\x02+\x87\xd6?\xb4\xc8\x0cB\x102/8/2019\n15:31\x08Cash{\x14\x06B\x86a\x98@+\x87\xd6?ff\xd6@'
[2024-12-09T13:16:00.694+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '88b47b70-b01f-462f-8b04-b395708ed576', 'invoice_id': '649-29-6775', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Fashion accessories', 'unit_price': 33.52000045776367, 'quantity': 1, 'tax_5_percent': 1.6759999990463257, 'total': 35.19599914550781, 'date': '2/8/2019', 'time': '15:31', 'payment': 'Cash', 'cogs': 33.52000045776367, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 1.6759999990463257, 'rating': 6.699999809265137}
[2024-12-09T13:16:00.696+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H7f99649b-dedb-4b5c-a9f7-193388f17fa0\x16189-17-4241\x02A\x0cYangon\x0cNormal\x0cFemale&Fashion accessories\nW\xafB\x04\xa2E\x0cAd\x1b8C\x123/10/2019\n12:17\x16Credit card\nW/C\x86a\x98@\xa2E\x0cAff\xf6@'
[2024-12-09T13:16:00.698+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '7f99649b-dedb-4b5c-a9f7-193388f17fa0', 'invoice_id': '189-17-4241', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 87.66999816894531, 'quantity': 2, 'tax_5_percent': 8.767000198364258, 'total': 184.10699462890625, 'date': '3/10/2019', 'time': '12:17', 'payment': 'Credit card', 'cogs': 175.33999633789062, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 8.767000198364258, 'rating': 7.699999809265137}
[2024-12-09T13:16:00.700+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H419e4795-2244-42ef-95ac-1e80ca136155\x16145-94-9061\x02B\x10Mandalay\x0cNormal\x0cFemale$Food and beveragesR\xb8\xb0B\nR\xb8\xb0A\xec\xf1\xe7C\x121/25/2019\n19:48\x08Cashf\xe6\xdcC\x86a\x98@R\xb8\xb0A\x9a\x99\x19A'
[2024-12-09T13:16:00.701+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '419e4795-2244-42ef-95ac-1e80ca136155', 'invoice_id': '145-94-9061', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 88.36000061035156, 'quantity': 5, 'tax_5_percent': 22.09000015258789, 'total': 463.8900146484375, 'date': '1/25/2019', 'time': '19:48', 'payment': 'Cash', 'cogs': 441.79998779296875, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 22.09000015258789, 'rating': 9.600000381469727}
[2024-12-09T13:16:00.703+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H34b5556a-7fc9-412e-a500-faebc0492329\x16848-62-7243\x02A\x0cYangon\x0cNormal\x08Male"Health and beauty\xb8\x1e\xc7A\x12?53A\xe35kC\x123/15/2019\n15:36\x08Cash\x8f\x02`C\x86a\x98@?53A\xcd\xcc\xec@'
[2024-12-09T13:16:00.704+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '34b5556a-7fc9-412e-a500-faebc0492329', 'invoice_id': '848-62-7243', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 24.889999389648438, 'quantity': 9, 'tax_5_percent': 11.200499534606934, 'total': 235.2104949951172, 'date': '3/15/2019', 'time': '15:36', 'payment': 'Cash', 'cogs': 224.00999450683594, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 11.200499534606934, 'rating': 7.400000095367432}
[2024-12-09T13:16:00.705+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H7d48416f-c59b-4021-ae9a-0b8d16dd1ba0\x16871-79-8483\x02B\x10Mandalay\x0cNormal\x08Male&Fashion accessories\x8fB\xbcB\n\x8fB\xbcA\\\x17\xf7C\x122/25/2019\n19:39\x16Credit card3S\xebC\x86a\x98@\x8fB\xbcA\x9a\x99\x99@'
[2024-12-09T13:16:00.707+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '7d48416f-c59b-4021-ae9a-0b8d16dd1ba0', 'invoice_id': '871-79-8483', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Fashion accessories', 'unit_price': 94.12999725341797, 'quantity': 5, 'tax_5_percent': 23.532499313354492, 'total': 494.1824951171875, 'date': '2/25/2019', 'time': '19:39', 'payment': 'Credit card', 'cogs': 470.6499938964844, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 23.532499313354492, 'rating': 4.800000190734863}
[2024-12-09T13:16:00.710+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H8ef2200f-d61a-4e38-be72-65d432621792\x16149-71-6266\x02B\x10Mandalay\x0cMember\x08Male"Sports and travel\xd7#\x9cB\x12\xa8\x86\x0cB\xbcp8D\x121/28/2019\n12:43\x08CashR\xa8/D\x86a\x98@\xa8\x86\x0cB\x00\x00\x90@'
[2024-12-09T13:16:00.714+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '8ef2200f-d61a-4e38-be72-65d432621792', 'invoice_id': '149-71-6266', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 78.06999969482422, 'quantity': 9, 'tax_5_percent': 35.131500244140625, 'total': 737.761474609375, 'date': '1/28/2019', 'time': '12:43', 'payment': 'Cash', 'cogs': 702.6300048828125, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 35.131500244140625, 'rating': 4.5}
[2024-12-09T13:16:00.716+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H803f8c72-032d-44f7-a8b8-0a7f76056f5c\x16640-49-2076\x02B\x10Mandalay\x0cNormal\x08Male"Sports and travel\\\x8f\xa7B\x10J\x0c\x06B!\xf0/D\x121/10/2019\n14:49\x08Cash\\\x8f\'D\x86a\x98@J\x0c\x06B33\xa3@'
[2024-12-09T13:16:00.719+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '803f8c72-032d-44f7-a8b8-0a7f76056f5c', 'invoice_id': '640-49-2076', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 83.77999877929688, 'quantity': 8, 'tax_5_percent': 33.512001037597656, 'total': 703.7520141601562, 'date': '1/10/2019', 'time': '14:49', 'payment': 'Cash', 'cogs': 670.239990234375, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 33.512001037597656, 'rating': 5.099999904632568}
[2024-12-09T13:16:00.720+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H7752ba1c-f35c-4846-b477-36f0e99f3ea8\x16595-11-5460\x02A\x0cYangon\x0cNormal\x08Male"Health and beauty\xf6(\xc1B\x04+\x87\x1aAh\xd1JC\x123/15/2019\n10:12\x16Credit card\xf6(AC\x86a\x98@+\x87\x1aA33\xa3@'
[2024-12-09T13:16:00.722+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '7752ba1c-f35c-4846-b477-36f0e99f3ea8', 'invoice_id': '595-11-5460', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 96.58000183105469, 'quantity': 2, 'tax_5_percent': 9.657999992370605, 'total': 202.8179931640625, 'date': '3/15/2019', 'time': '10:12', 'payment': 'Credit card', 'cogs': 193.16000366210938, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 9.657999992370605, 'rating': 5.099999904632568}
[2024-12-09T13:16:00.723+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H75cfab7a-af46-4bd5-b37d-392256390606\x16183-56-6882\x02C\x12Naypyitaw\x0cMember\x0cFemale$Food and beverages\n\xd7\xc6B\x08o\x12\x9fA1\xc8\xd0C\x102/6/2019\n10:42\x0eEwallet\n\xd7\xc6C\x86a\x98@o\x12\x9fA\x00\x00\xf0@'
[2024-12-09T13:16:00.725+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '75cfab7a-af46-4bd5-b37d-392256390606', 'invoice_id': '183-56-6882', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 99.41999816894531, 'quantity': 4, 'tax_5_percent': 19.884000778198242, 'total': 417.5639953613281, 'date': '2/6/2019', 'time': '10:42', 'payment': 'Ewallet', 'cogs': 397.67999267578125, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 19.884000778198242, 'rating': 7.5}
[2024-12-09T13:16:00.727+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H7eec7556-1a7f-4c33-8703-480f0a8dac0a\x16232-16-2483\x02C\x12Naypyitaw\x0cMember\x0cFemale"Sports and travelq=\x88B\x02\xe7\xfbY@P\r\x8fB\x101/7/2019\n12:28\x0eEwalletq=\x88B\x86a\x98@\xe7\xfbY@\x9a\x99\xd9@'
[2024-12-09T13:16:00.729+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '7eec7556-1a7f-4c33-8703-480f0a8dac0a', 'invoice_id': '232-16-2483', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 68.12000274658203, 'quantity': 1, 'tax_5_percent': 3.4059998989105225, 'total': 71.5260009765625, 'date': '1/7/2019', 'time': '12:28', 'payment': 'Ewallet', 'cogs': 68.12000274658203, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 3.4059998989105225, 'rating': 6.800000190734863}
[2024-12-09T13:16:00.730+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H5e539cd3-531d-4289-8479-d68a6825df05\x16129-29-8530\x02A\x0cYangon\x0cMember\x08Male"Sports and travel\xe1zzB\n\xe1zzA\xa4`\xa4C\x123/10/2019\n19:15\x0eEwallet\xcd\x8c\x9cC\x86a\x98@\xe1zzA\x00\x00\xe0@'
[2024-12-09T13:16:00.732+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '5e539cd3-531d-4289-8479-d68a6825df05', 'invoice_id': '129-29-8530', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Sports and travel', 'unit_price': 62.619998931884766, 'quantity': 5, 'tax_5_percent': 15.654999732971191, 'total': 328.7550048828125, 'date': '3/10/2019', 'time': '19:15', 'payment': 'Ewallet', 'cogs': 313.1000061035156, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 15.654999732971191, 'rating': 7.0}
[2024-12-09T13:16:00.734+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H64404516-b69b-40e4-9df6-b1d0d321d406\x16272-65-1806\x02A\x0cYangon\x0cNormal\x0cFemale,Electronic accessories\x1f\x85sB\x12\x02+\xdbA9\xd4\x0fD\x121/15/2019\n17:17\x0eEwallet\xe1\xfa\x08D\x86a\x98@\x02+\xdbAff\x96@'
[2024-12-09T13:16:00.735+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '64404516-b69b-40e4-9df6-b1d0d321d406', 'invoice_id': '272-65-1806', 'branch': 'A', 'city': 'Yangon', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 60.880001068115234, 'quantity': 9, 'tax_5_percent': 27.395999908447266, 'total': 575.3159790039062, 'date': '1/15/2019', 'time': '17:17', 'payment': 'Ewallet', 'cogs': 547.9199829101562, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 27.395999908447266, 'rating': 4.699999809265137}
[2024-12-09T13:16:00.737+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H529637a3-3c36-476e-ae90-76140f5676bb\x16333-73-7901\x02C\x12Naypyitaw\x0cNormal\x0cFemale"Health and beauty\x14\xae[B\x10w\xbe\xafA\xfc\xa9\xe6C\x123/23/2019\n13:24\x0eEwallet\x14\xae\xdbC\x86a\x98@w\xbe\xafA33\xf3@'
[2024-12-09T13:16:00.738+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '529637a3-3c36-476e-ae90-76140f5676bb', 'invoice_id': '333-73-7901', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Normal', 'gender': 'Female', 'product_line': 'Health and beauty', 'unit_price': 54.91999816894531, 'quantity': 8, 'tax_5_percent': 21.968000411987305, 'total': 461.3280029296875, 'date': '3/23/2019', 'time': '13:24', 'payment': 'Ewallet', 'cogs': 439.3599853515625, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 21.968000411987305, 'rating': 7.599999904632568}
[2024-12-09T13:16:00.740+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H08f99755-4438-4a2b-8135-14ae6f1c88b8\x16777-82-7220\x02B\x10Mandalay\x0cMember\x08Male$Home and lifestyle\xc3\xf5\xf0A\x10\x9c\xc4@A\x0c\x02}C\x103/3/2019\n13:01\x08Cash\xc3\xf5pC\x86a\x98@\x9c\xc4@Aff\xf6@'
[2024-12-09T13:16:00.741+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '08f99755-4438-4a2b-8135-14ae6f1c88b8', 'invoice_id': '777-82-7220', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 30.1200008392334, 'quantity': 8, 'tax_5_percent': 12.04800033569336, 'total': 253.00799560546875, 'date': '3/3/2019', 'time': '13:01', 'payment': 'Cash', 'cogs': 240.9600067138672, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 12.04800033569336, 'rating': 7.699999809265137}
[2024-12-09T13:16:00.744+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hdb0339af-6da0-4626-9e49-4150f8d3eae4\x16280-35-5823\x02B\x10Mandalay\x0cMember\x0cFemale$Home and lifestyle\xa4p\xadB\x02\x83\xc0\x8a@\xac\x1c\xb6B\x121/17/2019\n18:45\x0eEwallet\xa4p\xadB\x86a\x98@\x83\xc0\x8a@\xcd\xcc\xfc@'
[2024-12-09T13:16:00.746+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'db0339af-6da0-4626-9e49-4150f8d3eae4', 'invoice_id': '280-35-5823', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Home and lifestyle', 'unit_price': 86.72000122070312, 'quantity': 1, 'tax_5_percent': 4.335999965667725, 'total': 91.05599975585938, 'date': '1/17/2019', 'time': '18:45', 'payment': 'Ewallet', 'cogs': 86.72000122070312, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 4.335999965667725, 'rating': 7.900000095367432}
[2024-12-09T13:16:00.748+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H12b099b1-33a3-4354-87b4-ad999e88d53b\x16554-53-8700\x02C\x12Naypyitaw\x0cMember\x08Male$Home and lifestyle\xa4p`B\x04P\x8d\xb3@y\xa9\xebB\x102/2/2019\n10:11\x08Cash\xa4p\xe0B\x86a\x98@P\x8d\xb3@\x9a\x99\xc9@'
[2024-12-09T13:16:00.750+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '12b099b1-33a3-4354-87b4-ad999e88d53b', 'invoice_id': '554-53-8700', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Home and lifestyle', 'unit_price': 56.11000061035156, 'quantity': 2, 'tax_5_percent': 5.611000061035156, 'total': 117.83100128173828, 'date': '2/2/2019', 'time': '10:11', 'payment': 'Cash', 'cogs': 112.22000122070312, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 5.611000061035156, 'rating': 6.300000190734863}
[2024-12-09T13:16:00.752+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H797c3a1c-623f-40dd-a78e-1c41e6e87779\x16354-25-5821\x02B\x10Mandalay\x0cMember\x0cFemale"Sports and travelq=\x8aB\x0cT\xe3\xa5A^\xba\xd9C\x102/8/2019\n13:03\x08Cash)\\\xcfC\x86a\x98@T\xe3\xa5A33\xb3@'
[2024-12-09T13:16:00.756+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '797c3a1c-623f-40dd-a78e-1c41e6e87779', 'invoice_id': '354-25-5821', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Sports and travel', 'unit_price': 69.12000274658203, 'quantity': 6, 'tax_5_percent': 20.736000061035156, 'total': 435.45599365234375, 'date': '2/8/2019', 'time': '13:03', 'payment': 'Cash', 'cogs': 414.7200012207031, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 20.736000061035156, 'rating': 5.599999904632568}
[2024-12-09T13:16:00.758+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hb7d0cbf2-71b5-4866-a1e3-140d3da5db29\x16228-96-1411\x02C\x12Naypyitaw\x0cMember\x0cFemale$Food and beveragesff\xc5B\x10\x85\xeb\x1dB\x1fEOD\x103/4/2019\n20:39\x08CashffED\x86a\x98@\x85\xeb\x1dB33\xf3@'
[2024-12-09T13:16:00.760+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'b7d0cbf2-71b5-4866-a1e3-140d3da5db29', 'invoice_id': '228-96-1411', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 98.69999694824219, 'quantity': 8, 'tax_5_percent': 39.47999954223633, 'total': 829.0800170898438, 'date': '3/4/2019', 'time': '20:39', 'payment': 'Cash', 'cogs': 789.5999755859375, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 39.47999954223633, 'rating': 7.599999904632568}
[2024-12-09T13:16:00.763+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hfd98a58d-5d3a-4fdf-a33c-33765f50172f\x16617-15-4209\x02C\x12Naypyitaw\x0cMember\x08Male"Health and beauty\x85\xebuA\x04j\xbc\xc4?\xa6\x1b\x01B\x123/16/2019\n19:47\x08Cash\x85\xeb\xf5A\x86a\x98@j\xbc\xc4?ff\xe6@'
[2024-12-09T13:16:00.765+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'fd98a58d-5d3a-4fdf-a33c-33765f50172f', 'invoice_id': '617-15-4209', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 15.369999885559082, 'quantity': 2, 'tax_5_percent': 1.5369999408721924, 'total': 32.277000427246094, 'date': '3/16/2019', 'time': '19:47', 'payment': 'Cash', 'cogs': 30.739999771118164, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 1.5369999408721924, 'rating': 7.199999809265137}
[2024-12-09T13:16:00.768+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H95d781c8-3a95-4ff4-826f-b95b9362f851\x16132-32-9879\x02B\x10Mandalay\x0cMember\x0cFemale,Electronic accessories\x85\xeb\xbbB\x08\x04V\x96A\xe5P\xc5C\x103/9/2019\n18:00\x08Cash\x85\xeb\xbbC\x86a\x98@\x04V\x96A\x00\x00\x18A'
[2024-12-09T13:16:00.771+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '95d781c8-3a95-4ff4-826f-b95b9362f851', 'invoice_id': '132-32-9879', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Electronic accessories', 'unit_price': 93.95999908447266, 'quantity': 4, 'tax_5_percent': 18.79199981689453, 'total': 394.6319885253906, 'date': '3/9/2019', 'time': '18:00', 'payment': 'Cash', 'cogs': 375.8399963378906, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 18.79199981689453, 'rating': 9.5}
[2024-12-09T13:16:00.773+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H085098be-4421-45cf-b9c9-246035d70fea\x16370-41-7321\x02B\x10Mandalay\x0cMember\x08Male"Health and beauty\x8f\xc2bB\x12\x81\x15\xccA\x1d\xee\x05D\x122/27/2019\n17:24\x16Credit card\xe1\x1a\xffC\x86a\x98@\x81\x15\xccAff\x06A'
[2024-12-09T13:16:00.775+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '085098be-4421-45cf-b9c9-246035d70fea', 'invoice_id': '370-41-7321', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Health and beauty', 'unit_price': 56.689998626708984, 'quantity': 9, 'tax_5_percent': 25.510499954223633, 'total': 535.7205200195312, 'date': '2/27/2019', 'time': '17:24', 'payment': 'Credit card', 'cogs': 510.2099914550781, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 25.510499954223633, 'rating': 8.399999618530273}
[2024-12-09T13:16:00.778+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H2ef43d6f-6594-4e6c-b6d6-d44b8eb6747d\x16727-46-3608\x02B\x10Mandalay\x0cMember\x0cFemale$Food and beverages{\x14\xa0A\x12o\x12\x10A1\x18=C\x102/6/2019\n15:47\x0eEwallet\n\x174C\x86a\x98@o\x12\x10A33\x83@'
[2024-12-09T13:16:00.780+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '2ef43d6f-6594-4e6c-b6d6-d44b8eb6747d', 'invoice_id': '727-46-3608', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Food and beverages', 'unit_price': 20.010000228881836, 'quantity': 9, 'tax_5_percent': 9.004500389099121, 'total': 189.09449768066406, 'date': '2/6/2019', 'time': '15:47', 'payment': 'Ewallet', 'cogs': 180.08999633789062, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 9.004500389099121, 'rating': 4.099999904632568}
[2024-12-09T13:16:00.782+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03H0206221a-163f-458f-a29f-31e2e90f00b1\x16669-54-1719\x02B\x10Mandalay\x0cMember\x08Male,Electronic accessories\xa4p\x97A\x0c^\xba\xb5@\x9c\x84\xeeB\x122/10/2019\n12:45\x16Credit card\xf6(\xe3B\x86a\x98@^\xba\xb5@\x9a\x99\x01A'
[2024-12-09T13:16:00.784+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': '0206221a-163f-458f-a29f-31e2e90f00b1', 'invoice_id': '669-54-1719', 'branch': 'B', 'city': 'Mandalay', 'customer_type': 'Member', 'gender': 'Male', 'product_line': 'Electronic accessories', 'unit_price': 18.93000030517578, 'quantity': 6, 'tax_5_percent': 5.678999900817871, 'total': 119.25900268554688, 'date': '2/10/2019', 'time': '12:45', 'payment': 'Credit card', 'cogs': 113.58000183105469, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 5.678999900817871, 'rating': 8.100000381469727}
[2024-12-09T13:16:00.785+0000] {logging_mixin.py:190} INFO - b'\x00\x00\x00\x00\x03Hd3c51969-fdee-4350-bf09-aeded533214d\x16574-22-5561\x02C\x12Naypyitaw\x0cMember\x0cFemale&Fashion accessories\x8fB\xa5B\x14\x8fB%B\\\xe7XD\x123/19/2019\n17:08\x0eEwallet3\x93ND\x86a\x98@\x8fB%B\xcd\xcc\xfc@'
[2024-12-09T13:16:00.787+0000] {kafka_to_hive_with_redis.py:125} INFO - Consumed message: {'id': 'd3c51969-fdee-4350-bf09-aeded533214d', 'invoice_id': '574-22-5561', 'branch': 'C', 'city': 'Naypyitaw', 'customer_type': 'Member', 'gender': 'Female', 'product_line': 'Fashion accessories', 'unit_price': 82.62999725341797, 'quantity': 10, 'tax_5_percent': 41.314998626708984, 'total': 867.614990234375, 'date': '3/19/2019', 'time': '17:08', 'payment': 'Ewallet', 'cogs': 826.2999877929688, 'gross_margin_percentage': 4.761904716491699, 'gross_income': 41.314998626708984, 'rating': 7.900000095367432}
[2024-12-09T13:16:00.794+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'c0410f6c-ba77-4563-a5cf-0906c46a9358', '750-67-8428', 'A', 'Yangon', 'Member', 'Female', 
                        'Health and beauty', 74.69000244140625, 7, 26.14150047302246, 548.9714965820312, 
                        '1/5/2019', '13:08', 'Ewallet', 522.8300170898438, 4.761904716491699, 
                        26.14150047302246, 9.100000381469727
                    )
                
[2024-12-09T13:16:19.457+0000] {csv_to_kafka_with_redis.py:99} INFO - Redis batch status: READY
[2024-12-09T13:16:45.558+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:16:45.807+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'd502b072-f0f0-40f8-8048-de7b333c1d3d', '226-31-3081', 'C', 'Naypyitaw', 'Normal', 'Female', 
                        'Electronic accessories', 15.279999732971191, 5, 3.819999933242798, 80.22000122070312, 
                        '3/8/2019', '10:29', 'Cash', 76.4000015258789, 4.761904716491699, 
                        3.819999933242798, 9.600000381469727
                    )
                
[2024-12-09T13:17:07.272+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:17:07.538+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '745c180f-81c8-4c38-a0c4-db9bc86c43e8', '631-41-3108', 'A', 'Yangon', 'Normal', 'Male', 
                        'Home and lifestyle', 46.33000183105469, 7, 16.215499877929688, 340.5255126953125, 
                        '3/3/2019', '13:23', 'Credit card', 324.30999755859375, 4.761904716491699, 
                        16.215499877929688, 7.400000095367432
                    )
                
[2024-12-09T13:17:20.060+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:17:20.084+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'c2943ea2-2e23-4eea-82d7-be55ff4c6279', '123-19-1176', 'A', 'Yangon', 'Member', 'Male', 
                        'Health and beauty', 58.220001220703125, 8, 23.288000106811523, 489.0480041503906, 
                        '1/27/2019', '20:33', 'Ewallet', 465.760009765625, 4.761904716491699, 
                        23.288000106811523, 8.399999618530273
                    )
                
[2024-12-09T13:17:26.047+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:17:26.070+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '4faeac6d-c7ed-4cfd-9a40-877e70cf6256', '373-73-7910', 'A', 'Yangon', 'Normal', 'Male', 
                        'Sports and travel', 86.30999755859375, 7, 30.208499908447266, 634.3784790039062, 
                        '2/8/2019', '10:37', 'Ewallet', 604.1699829101562, 4.761904716491699, 
                        30.208499908447266, 5.300000190734863
                    )
                
[2024-12-09T13:17:38.622+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:17:38.755+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '464bed22-4311-4f11-8af9-e9e0bfa8b0fd', '699-14-3026', 'C', 'Naypyitaw', 'Normal', 'Male', 
                        'Electronic accessories', 85.38999938964844, 7, 29.886499404907227, 627.6165161132812, 
                        '3/25/2019', '18:30', 'Ewallet', 597.72998046875, 4.761904716491699, 
                        29.886499404907227, 4.099999904632568
                    )
                
[2024-12-09T13:17:44.671+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:17:44.689+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'a86b2bdd-261b-41e7-9fef-b6f869c3291b', '355-53-5943', 'A', 'Yangon', 'Member', 'Female', 
                        'Electronic accessories', 68.83999633789062, 6, 20.652000427246094, 433.6919860839844, 
                        '2/25/2019', '14:36', 'Ewallet', 413.0400085449219, 4.761904716491699, 
                        20.652000427246094, 5.800000190734863
                    )
                
[2024-12-09T13:17:52.347+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:17:52.379+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '26673db7-f051-4d03-b64d-62929c74dae4', '315-22-5665', 'C', 'Naypyitaw', 'Normal', 'Female', 
                        'Home and lifestyle', 73.55999755859375, 10, 36.779998779296875, 772.3800048828125, 
                        '2/24/2019', '11:38', 'Ewallet', 735.5999755859375, 4.761904716491699, 
                        36.779998779296875, 8.0
                    )
                
[2024-12-09T13:17:58.568+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:17:58.607+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '37492b1b-e4a7-440e-896b-dc25164901af', '665-32-9167', 'A', 'Yangon', 'Member', 'Female', 
                        'Health and beauty', 36.2599983215332, 2, 3.625999927520752, 76.14600372314453, 
                        '1/10/2019', '17:15', 'Credit card', 72.5199966430664, 4.761904716491699, 
                        3.625999927520752, 7.199999809265137
                    )
                
[2024-12-09T13:18:05.265+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:05.303+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'b01e70ba-9e53-4b67-b4ea-93e21151b202', '692-92-5582', 'B', 'Mandalay', 'Member', 'Female', 
                        'Food and beverages', 54.84000015258789, 3, 8.22599983215332, 172.74600219726562, 
                        '2/20/2019', '13:27', 'Credit card', 164.52000427246094, 4.761904716491699, 
                        8.22599983215332, 5.900000095367432
                    )
                
[2024-12-09T13:18:10.389+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:10.445+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '3d079f09-69f8-4aa5-bc46-75663aed8f91', '351-62-0822', 'B', 'Mandalay', 'Member', 'Female', 
                        'Fashion accessories', 14.479999542236328, 4, 2.8959999084472656, 60.816001892089844, 
                        '2/6/2019', '18:07', 'Ewallet', 57.91999816894531, 4.761904716491699, 
                        2.8959999084472656, 4.5
                    )
                
[2024-12-09T13:18:15.374+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:15.436+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '0766b322-ebef-409a-ba29-9a539649b5d7', '529-56-3974', 'B', 'Mandalay', 'Member', 'Male', 
                        'Electronic accessories', 25.510000228881836, 4, 5.1020002365112305, 107.14199829101562, 
                        '3/9/2019', '17:03', 'Cash', 102.04000091552734, 4.761904716491699, 
                        5.1020002365112305, 6.800000190734863
                    )
                
[2024-12-09T13:18:23.330+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:23.370+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'd4bd851d-9537-49cf-90d9-5f1f663e44ec', '365-64-0515', 'A', 'Yangon', 'Normal', 'Female', 
                        'Electronic accessories', 46.95000076293945, 5, 11.737500190734863, 246.4875030517578, 
                        '2/12/2019', '10:25', 'Ewallet', 234.75, 4.761904716491699, 
                        11.737500190734863, 7.099999904632568
                    )
                
[2024-12-09T13:18:30.868+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:30.940+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'dfe15ddb-96dd-4df1-bbf2-92b4985c7a9b', '252-56-2699', 'A', 'Yangon', 'Normal', 'Male', 
                        'Food and beverages', 43.189998626708984, 10, 21.594999313354492, 453.4949951171875, 
                        '2/7/2019', '16:48', 'Ewallet', 431.8999938964844, 4.761904716491699, 
                        21.594999313354492, 8.199999809265137
                    )
                
[2024-12-09T13:18:37.875+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:37.899+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '77c3aeff-cbe0-4ec1-b338-29ee01ba1905', '829-34-3910', 'A', 'Yangon', 'Normal', 'Female', 
                        'Health and beauty', 71.37999725341797, 10, 35.689998626708984, 749.489990234375, 
                        '3/29/2019', '19:21', 'Cash', 713.7999877929688, 4.761904716491699, 
                        35.689998626708984, 5.699999809265137
                    )
                
[2024-12-09T13:18:43.362+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:43.402+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '58f47858-b827-45be-8077-5288f7358ca9', '299-46-1805', 'B', 'Mandalay', 'Member', 'Female', 
                        'Sports and travel', 93.72000122070312, 6, 28.115999221801758, 590.4359741210938, 
                        '1/15/2019', '16:19', 'Cash', 562.3200073242188, 4.761904716491699, 
                        28.115999221801758, 4.5
                    )
                
[2024-12-09T13:18:49.177+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:49.215+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '148618f0-ebf8-43e6-9397-2b8e8b2fe319', '656-95-9349', 'A', 'Yangon', 'Member', 'Female', 
                        'Health and beauty', 68.93000030517578, 7, 24.125499725341797, 506.635498046875, 
                        '3/11/2019', '11:03', 'Credit card', 482.510009765625, 4.761904716491699, 
                        24.125499725341797, 4.599999904632568
                    )
                
[2024-12-09T13:18:53.387+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:53.400+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'f9656a9d-5162-4f7c-9116-6d0d5c325816', '765-26-6951', 'A', 'Yangon', 'Normal', 'Male', 
                        'Sports and travel', 72.61000061035156, 6, 21.783000946044922, 457.4429931640625, 
                        '1/1/2019', '10:39', 'Credit card', 435.6600036621094, 4.761904716491699, 
                        21.783000946044922, 6.900000095367432
                    )
                
[2024-12-09T13:18:58.342+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:18:58.371+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '2adcf19a-8f0e-4fd9-a9a2-b66551e49065', '329-62-1586', 'A', 'Yangon', 'Normal', 'Male', 
                        'Food and beverages', 54.66999816894531, 3, 8.200499534606934, 172.2104949951172, 
                        '1/21/2019', '18:00', 'Credit card', 164.00999450683594, 4.761904716491699, 
                        8.200499534606934, 8.600000381469727
                    )
                
[2024-12-09T13:19:03.823+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:19:03.840+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'c4df17ab-0544-4b69-8865-007dbec9b6a6', '319-50-3348', 'B', 'Mandalay', 'Normal', 'Female', 
                        'Home and lifestyle', 40.29999923706055, 2, 4.03000020980835, 84.62999725341797, 
                        '3/11/2019', '15:30', 'Ewallet', 80.5999984741211, 4.761904716491699, 
                        4.03000020980835, 4.400000095367432
                    )
                
[2024-12-09T13:19:09.316+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:19:09.353+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'b058895f-1eb2-4f00-97d6-a14c8e424ba2', '300-71-4605', 'C', 'Naypyitaw', 'Member', 'Male', 
                        'Electronic accessories', 86.04000091552734, 5, 21.510000228881836, 451.7099914550781, 
                        '2/25/2019', '11:24', 'Ewallet', 430.20001220703125, 4.761904716491699, 
                        21.510000228881836, 4.800000190734863
                    )
                
[2024-12-09T13:19:13.958+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:19:14.004+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'a694abfe-6ce4-4974-990f-a069998691f7', '371-85-5789', 'B', 'Mandalay', 'Normal', 'Male', 
                        'Health and beauty', 87.9800033569336, 3, 13.196999549865723, 277.1369934082031, 
                        '3/5/2019', '10:40', 'Ewallet', 263.94000244140625, 4.761904716491699, 
                        13.196999549865723, 5.099999904632568
                    )
                
[2024-12-09T13:19:19.021+0000] {kafka_to_hive_with_redis.py:140} INFO - Inserted message into Hive.
[2024-12-09T13:19:19.170+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '6515077a-3049-4b72-819e-0c5a6227448e', '273-16-6619', 'B', 'Mandalay', 'Normal', 'Male', 
                        'Home and lifestyle', 33.20000076293945, 2, 3.319999933242798, 69.72000122070312, 
                        '3/15/2019', '12:20', 'Credit card', 66.4000015258789, 4.761904716491699, 
                        3.319999933242798, 4.400000095367432
                    )
                
[2024-12-09T13:20:08.475+0000] {job.py:229} INFO - Heartbeat recovered after 12.13 seconds
[2024-12-09T13:20:19.773+0000] {job.py:229} INFO - Heartbeat recovered after 13.05 seconds
[2024-12-09T13:20:22.531+0000] {kafka_to_hive_with_redis.py:142} ERROR - Error inserting into Hive: TExecuteStatementResp(status=TStatus(statusCode=3, infoMessages=['*org.apache.hive.service.cli.HiveSQLException:Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask. Unable to fetch table sales. Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:17:16', 'org.apache.hive.service.cli.operation.Operation:toSQLException:Operation.java:380', 'org.apache.hive.service.cli.operation.SQLOperation:runQuery:SQLOperation.java:257', 'org.apache.hive.service.cli.operation.SQLOperation:runInternal:SQLOperation.java:293', 'org.apache.hive.service.cli.operation.Operation:run:Operation.java:320', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatementInternal:HiveSessionImpl.java:530', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatement:HiveSessionImpl.java:506', 'org.apache.hive.service.cli.CLIService:executeStatement:CLIService.java:280', 'org.apache.hive.service.cli.thrift.ThriftCLIService:ExecuteStatement:ThriftCLIService.java:531', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1437', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1422', 'org.apache.thrift.ProcessFunction:process:ProcessFunction.java:39', 'org.apache.thrift.TBaseProcessor:process:TBaseProcessor.java:39', 'org.apache.hive.service.auth.TSetIpAddressProcessor:process:TSetIpAddressProcessor.java:56', 'org.apache.thrift.server.TThreadPoolServer$WorkerProcess:run:TThreadPoolServer.java:286', 'java.util.concurrent.ThreadPoolExecutor:runWorker:ThreadPoolExecutor.java:1142', 'java.util.concurrent.ThreadPoolExecutor$Worker:run:ThreadPoolExecutor.java:617', 'java.lang.Thread:run:Thread.java:748', '*org.apache.hadoop.hive.ql.metadata.HiveException:Unable to fetch table sales. Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:27:11', 'org.apache.hadoop.hive.ql.metadata.Hive:getTable:Hive.java:1282', 'org.apache.hadoop.hive.ql.metadata.Hive:getTable:Hive.java:1229', 'org.apache.hadoop.hive.ql.metadata.Hive:getTable:Hive.java:1216', 'org.apache.hadoop.hive.ql.exec.MoveTask:execute:MoveTask.java:296', 'org.apache.hadoop.hive.ql.exec.Task:executeTask:Task.java:199', 'org.apache.hadoop.hive.ql.exec.TaskRunner:runSequential:TaskRunner.java:100', 'org.apache.hadoop.hive.ql.Driver:launchTask:Driver.java:2183', 'org.apache.hadoop.hive.ql.Driver:execute:Driver.java:1839', 'org.apache.hadoop.hive.ql.Driver:runInternal:Driver.java:1526', 'org.apache.hadoop.hive.ql.Driver:run:Driver.java:1237', 'org.apache.hadoop.hive.ql.Driver:run:Driver.java:1232', 'org.apache.hive.service.cli.operation.SQLOperation:runQuery:SQLOperation.java:255', '*java.lang.RuntimeException:Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:34:7', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1701', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:<init>:RetryingMetaStoreClient.java:83', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:133', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:104', 'org.apache.hadoop.hive.ql.metadata.Hive:createMetaStoreClient:Hive.java:3600', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3652', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3632', 'org.apache.hadoop.hive.ql.metadata.Hive:getTable:Hive.java:1274', '*java.lang.reflect.InvocationTargetException:null:37:3', 'sun.reflect.GeneratedConstructorAccessor27:newInstance::-1', 'sun.reflect.DelegatingConstructorAccessorImpl:newInstance:DelegatingConstructorAccessorImpl.java:45', 'java.lang.reflect.Constructor:newInstance:Constructor.java:423', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1699', '*org.apache.hadoop.hive.metastore.api.MetaException:Could not connect to meta store using any of the URIs provided. Most recent failure: org.apache.thrift.transport.TTransportException: java.net.UnknownHostException: hive-metastore\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:226)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaStoreClient.java:480)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:247)\n\tat org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\n\tat sun.reflect.GeneratedConstructorAccessor27.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1699)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:1274)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:1229)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getTable(Hive.java:1216)\n\tat org.apache.hadoop.hive.ql.exec.MoveTask.execute(MoveTask.java:296)\n\tat org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:199)\n\tat org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:100)\n\tat org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:2183)\n\tat org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1839)\n\tat org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1526)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1237)\n\tat org.apache.hadoop.hive.ql.Driver.run(Driver.java:1232)\n\tat org.apache.hive.service.cli.operation.SQLOperation.runQuery(SQLOperation.java:255)\n\tat org.apache.hive.service.cli.operation.SQLOperation.runInternal(SQLOperation.java:293)\n\tat org.apache.hive.service.cli.operation.Operation.run(Operation.java:320)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementInternal(HiveSessionImpl.java:530)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatement(HiveSessionImpl.java:506)\n\tat org.apache.hive.service.cli.CLIService.executeStatement(CLIService.java:280)\n\tat org.apache.hive.service.cli.thrift.ThriftCLIService.ExecuteStatement(ThriftCLIService.java:531)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1437)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1422)\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\n\tat org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)\n\tat org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:286)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.net.UnknownHostException: hive-metastore\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:589)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:221)\n\t... 40 more\n:40:2', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:open:HiveMetaStoreClient.java:529', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:<init>:HiveMetaStoreClient.java:247', 'org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:<init>:SessionHiveMetaStoreClient.java:70'], sqlState='08S01', errorCode=1, errorMessage='Error while processing statement: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MoveTask. Unable to fetch table sales. Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient'), operationHandle=None)
[2024-12-09T13:20:22.568+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '62daf8cf-6c9b-4841-aeac-4e4363448ba2', '636-48-8204', 'A', 'Yangon', 'Normal', 'Male', 
                        'Electronic accessories', 34.560001373291016, 5, 8.640000343322754, 181.44000244140625, 
                        '2/17/2019', '11:15', 'Ewallet', 172.8000030517578, 4.761904716491699, 
                        8.640000343322754, 9.899999618530273
                    )
                
[2024-12-09T13:20:49.292+0000] {kafka_to_hive_with_redis.py:142} ERROR - Error inserting into Hive: TExecuteStatementResp(status=TStatus(statusCode=3, infoMessages=['*org.apache.hive.service.cli.HiveSQLException:Error while compiling statement: FAILED: RuntimeException Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:17:16', 'org.apache.hive.service.cli.operation.Operation:toSQLException:Operation.java:380', 'org.apache.hive.service.cli.operation.SQLOperation:prepare:SQLOperation.java:206', 'org.apache.hive.service.cli.operation.SQLOperation:runInternal:SQLOperation.java:290', 'org.apache.hive.service.cli.operation.Operation:run:Operation.java:320', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatementInternal:HiveSessionImpl.java:530', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatement:HiveSessionImpl.java:506', 'org.apache.hive.service.cli.CLIService:executeStatement:CLIService.java:280', 'org.apache.hive.service.cli.thrift.ThriftCLIService:ExecuteStatement:ThriftCLIService.java:531', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1437', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1422', 'org.apache.thrift.ProcessFunction:process:ProcessFunction.java:39', 'org.apache.thrift.TBaseProcessor:process:TBaseProcessor.java:39', 'org.apache.hive.service.auth.TSetIpAddressProcessor:process:TSetIpAddressProcessor.java:56', 'org.apache.thrift.server.TThreadPoolServer$WorkerProcess:run:TThreadPoolServer.java:286', 'java.util.concurrent.ThreadPoolExecutor:runWorker:ThreadPoolExecutor.java:1142', 'java.util.concurrent.ThreadPoolExecutor$Worker:run:ThreadPoolExecutor.java:617', 'java.lang.Thread:run:Thread.java:748', '*java.lang.RuntimeException:Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:26:10', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1701', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:<init>:RetryingMetaStoreClient.java:83', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:133', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:104', 'org.apache.hadoop.hive.ql.metadata.Hive:createMetaStoreClient:Hive.java:3600', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3652', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3632', 'org.apache.hadoop.hive.ql.Driver:compile:Driver.java:493', 'org.apache.hadoop.hive.ql.Driver:compileInternal:Driver.java:1317', 'org.apache.hadoop.hive.ql.Driver:compileAndRespond:Driver.java:1295', 'org.apache.hive.service.cli.operation.SQLOperation:prepare:SQLOperation.java:204', '*java.lang.reflect.InvocationTargetException:null:29:3', 'sun.reflect.GeneratedConstructorAccessor27:newInstance::-1', 'sun.reflect.DelegatingConstructorAccessorImpl:newInstance:DelegatingConstructorAccessorImpl.java:45', 'java.lang.reflect.Constructor:newInstance:Constructor.java:423', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1699', '*org.apache.hadoop.hive.metastore.api.MetaException:Could not connect to meta store using any of the URIs provided. Most recent failure: org.apache.thrift.transport.TTransportException: java.net.UnknownHostException: hive-metastore\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:226)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaStoreClient.java:480)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:247)\n\tat org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\n\tat sun.reflect.GeneratedConstructorAccessor27.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1699)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:493)\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1317)\n\tat org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:1295)\n\tat org.apache.hive.service.cli.operation.SQLOperation.prepare(SQLOperation.java:204)\n\tat org.apache.hive.service.cli.operation.SQLOperation.runInternal(SQLOperation.java:290)\n\tat org.apache.hive.service.cli.operation.Operation.run(Operation.java:320)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementInternal(HiveSessionImpl.java:530)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatement(HiveSessionImpl.java:506)\n\tat org.apache.hive.service.cli.CLIService.executeStatement(CLIService.java:280)\n\tat org.apache.hive.service.cli.thrift.ThriftCLIService.ExecuteStatement(ThriftCLIService.java:531)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1437)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1422)\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\n\tat org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)\n\tat org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:286)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.net.UnknownHostException: hive-metastore\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:589)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:221)\n\t... 32 more\n:32:2', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:open:HiveMetaStoreClient.java:529', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:<init>:HiveMetaStoreClient.java:247', 'org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:<init>:SessionHiveMetaStoreClient.java:70'], sqlState='42000', errorCode=40000, errorMessage='Error while compiling statement: FAILED: RuntimeException Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient'), operationHandle=None)
[2024-12-09T13:20:49.519+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '60ebbc3c-11dd-48e6-b94a-31400228c55e', '549-59-1358', 'A', 'Yangon', 'Member', 'Male', 
                        'Sports and travel', 88.62999725341797, 3, 13.294500350952148, 279.18450927734375, 
                        '3/2/2019', '17:36', 'Ewallet', 265.8900146484375, 4.761904716491699, 
                        13.294500350952148, 6.0
                    )
                
[2024-12-09T13:21:08.801+0000] {job.py:229} INFO - Heartbeat recovered after 11.57 seconds
[2024-12-09T13:21:35.861+0000] {job.py:229} INFO - Heartbeat recovered after 28.06 seconds
[2024-12-09T13:21:34.809+0000] {kafka_to_hive_with_redis.py:142} ERROR - Error inserting into Hive: TExecuteStatementResp(status=TStatus(statusCode=3, infoMessages=['*org.apache.hive.service.cli.HiveSQLException:Error while compiling statement: FAILED: RuntimeException Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:17:16', 'org.apache.hive.service.cli.operation.Operation:toSQLException:Operation.java:380', 'org.apache.hive.service.cli.operation.SQLOperation:prepare:SQLOperation.java:206', 'org.apache.hive.service.cli.operation.SQLOperation:runInternal:SQLOperation.java:290', 'org.apache.hive.service.cli.operation.Operation:run:Operation.java:320', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatementInternal:HiveSessionImpl.java:530', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatement:HiveSessionImpl.java:506', 'org.apache.hive.service.cli.CLIService:executeStatement:CLIService.java:280', 'org.apache.hive.service.cli.thrift.ThriftCLIService:ExecuteStatement:ThriftCLIService.java:531', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1437', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1422', 'org.apache.thrift.ProcessFunction:process:ProcessFunction.java:39', 'org.apache.thrift.TBaseProcessor:process:TBaseProcessor.java:39', 'org.apache.hive.service.auth.TSetIpAddressProcessor:process:TSetIpAddressProcessor.java:56', 'org.apache.thrift.server.TThreadPoolServer$WorkerProcess:run:TThreadPoolServer.java:286', 'java.util.concurrent.ThreadPoolExecutor:runWorker:ThreadPoolExecutor.java:1142', 'java.util.concurrent.ThreadPoolExecutor$Worker:run:ThreadPoolExecutor.java:617', 'java.lang.Thread:run:Thread.java:748', '*java.lang.RuntimeException:Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:26:10', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1701', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:<init>:RetryingMetaStoreClient.java:83', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:133', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:104', 'org.apache.hadoop.hive.ql.metadata.Hive:createMetaStoreClient:Hive.java:3600', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3652', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3632', 'org.apache.hadoop.hive.ql.Driver:compile:Driver.java:493', 'org.apache.hadoop.hive.ql.Driver:compileInternal:Driver.java:1317', 'org.apache.hadoop.hive.ql.Driver:compileAndRespond:Driver.java:1295', 'org.apache.hive.service.cli.operation.SQLOperation:prepare:SQLOperation.java:204', '*java.lang.reflect.InvocationTargetException:null:29:3', 'sun.reflect.GeneratedConstructorAccessor27:newInstance::-1', 'sun.reflect.DelegatingConstructorAccessorImpl:newInstance:DelegatingConstructorAccessorImpl.java:45', 'java.lang.reflect.Constructor:newInstance:Constructor.java:423', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1699', '*org.apache.hadoop.hive.metastore.api.MetaException:Could not connect to meta store using any of the URIs provided. Most recent failure: org.apache.thrift.transport.TTransportException: java.net.UnknownHostException: hive-metastore\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:226)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaStoreClient.java:480)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:247)\n\tat org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\n\tat sun.reflect.GeneratedConstructorAccessor27.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1699)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:493)\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1317)\n\tat org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:1295)\n\tat org.apache.hive.service.cli.operation.SQLOperation.prepare(SQLOperation.java:204)\n\tat org.apache.hive.service.cli.operation.SQLOperation.runInternal(SQLOperation.java:290)\n\tat org.apache.hive.service.cli.operation.Operation.run(Operation.java:320)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementInternal(HiveSessionImpl.java:530)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatement(HiveSessionImpl.java:506)\n\tat org.apache.hive.service.cli.CLIService.executeStatement(CLIService.java:280)\n\tat org.apache.hive.service.cli.thrift.ThriftCLIService.ExecuteStatement(ThriftCLIService.java:531)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1437)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1422)\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\n\tat org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)\n\tat org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:286)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.net.UnknownHostException: hive-metastore\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:589)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:221)\n\t... 32 more\n:32:2', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:open:HiveMetaStoreClient.java:529', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:<init>:HiveMetaStoreClient.java:247', 'org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:<init>:SessionHiveMetaStoreClient.java:70'], sqlState='42000', errorCode=40000, errorMessage='Error while compiling statement: FAILED: RuntimeException Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient'), operationHandle=None)
[2024-12-09T13:21:37.070+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        'a29a576f-5f78-4a0c-a417-ffdacd9e8752', '227-03-5010', 'A', 'Yangon', 'Member', 'Female', 
                        'Home and lifestyle', 52.59000015258789, 8, 21.035999298095703, 441.7560119628906, 
                        '3/22/2019', '19:20', 'Credit card', 420.7200012207031, 4.761904716491699, 
                        21.035999298095703, 8.5
                    )
                
[2024-12-09T13:24:14.867+0000] {job.py:229} INFO - Heartbeat recovered after 158.33 seconds
[2024-12-09T13:25:25.420+0000] {kafka_to_hive_with_redis.py:142} ERROR - Error inserting into Hive: TExecuteStatementResp(status=TStatus(statusCode=3, infoMessages=['*org.apache.hive.service.cli.HiveSQLException:Error while compiling statement: FAILED: RuntimeException Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:17:16', 'org.apache.hive.service.cli.operation.Operation:toSQLException:Operation.java:380', 'org.apache.hive.service.cli.operation.SQLOperation:prepare:SQLOperation.java:206', 'org.apache.hive.service.cli.operation.SQLOperation:runInternal:SQLOperation.java:290', 'org.apache.hive.service.cli.operation.Operation:run:Operation.java:320', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatementInternal:HiveSessionImpl.java:530', 'org.apache.hive.service.cli.session.HiveSessionImpl:executeStatement:HiveSessionImpl.java:506', 'org.apache.hive.service.cli.CLIService:executeStatement:CLIService.java:280', 'org.apache.hive.service.cli.thrift.ThriftCLIService:ExecuteStatement:ThriftCLIService.java:531', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1437', 'org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement:getResult:TCLIService.java:1422', 'org.apache.thrift.ProcessFunction:process:ProcessFunction.java:39', 'org.apache.thrift.TBaseProcessor:process:TBaseProcessor.java:39', 'org.apache.hive.service.auth.TSetIpAddressProcessor:process:TSetIpAddressProcessor.java:56', 'org.apache.thrift.server.TThreadPoolServer$WorkerProcess:run:TThreadPoolServer.java:286', 'java.util.concurrent.ThreadPoolExecutor:runWorker:ThreadPoolExecutor.java:1142', 'java.util.concurrent.ThreadPoolExecutor$Worker:run:ThreadPoolExecutor.java:617', 'java.lang.Thread:run:Thread.java:748', '*java.lang.RuntimeException:Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:26:10', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1701', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:<init>:RetryingMetaStoreClient.java:83', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:133', 'org.apache.hadoop.hive.metastore.RetryingMetaStoreClient:getProxy:RetryingMetaStoreClient.java:104', 'org.apache.hadoop.hive.ql.metadata.Hive:createMetaStoreClient:Hive.java:3600', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3652', 'org.apache.hadoop.hive.ql.metadata.Hive:getMSC:Hive.java:3632', 'org.apache.hadoop.hive.ql.Driver:compile:Driver.java:493', 'org.apache.hadoop.hive.ql.Driver:compileInternal:Driver.java:1317', 'org.apache.hadoop.hive.ql.Driver:compileAndRespond:Driver.java:1295', 'org.apache.hive.service.cli.operation.SQLOperation:prepare:SQLOperation.java:204', '*java.lang.reflect.InvocationTargetException:null:29:3', 'sun.reflect.GeneratedConstructorAccessor27:newInstance::-1', 'sun.reflect.DelegatingConstructorAccessorImpl:newInstance:DelegatingConstructorAccessorImpl.java:45', 'java.lang.reflect.Constructor:newInstance:Constructor.java:423', 'org.apache.hadoop.hive.metastore.MetaStoreUtils:newInstance:MetaStoreUtils.java:1699', '*org.apache.hadoop.hive.metastore.api.MetaException:Could not connect to meta store using any of the URIs provided. Most recent failure: org.apache.thrift.transport.TTransportException: java.net.UnknownHostException: hive-metastore\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:226)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.open(HiveMetaStoreClient.java:480)\n\tat org.apache.hadoop.hive.metastore.HiveMetaStoreClient.<init>(HiveMetaStoreClient.java:247)\n\tat org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.<init>(SessionHiveMetaStoreClient.java:70)\n\tat sun.reflect.GeneratedConstructorAccessor27.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.java:1699)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.<init>(RetryingMetaStoreClient.java:83)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:133)\n\tat org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.java:104)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:3600)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3652)\n\tat org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:3632)\n\tat org.apache.hadoop.hive.ql.Driver.compile(Driver.java:493)\n\tat org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1317)\n\tat org.apache.hadoop.hive.ql.Driver.compileAndRespond(Driver.java:1295)\n\tat org.apache.hive.service.cli.operation.SQLOperation.prepare(SQLOperation.java:204)\n\tat org.apache.hive.service.cli.operation.SQLOperation.runInternal(SQLOperation.java:290)\n\tat org.apache.hive.service.cli.operation.Operation.run(Operation.java:320)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatementInternal(HiveSessionImpl.java:530)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.executeStatement(HiveSessionImpl.java:506)\n\tat org.apache.hive.service.cli.CLIService.executeStatement(CLIService.java:280)\n\tat org.apache.hive.service.cli.thrift.ThriftCLIService.ExecuteStatement(ThriftCLIService.java:531)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1437)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$ExecuteStatement.getResult(TCLIService.java:1422)\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\n\tat org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)\n\tat org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:286)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: java.net.UnknownHostException: hive-metastore\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:184)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:589)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:221)\n\t... 32 more\n:32:2', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:open:HiveMetaStoreClient.java:529', 'org.apache.hadoop.hive.metastore.HiveMetaStoreClient:<init>:HiveMetaStoreClient.java:247', 'org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient:<init>:SessionHiveMetaStoreClient.java:70'], sqlState='42000', errorCode=40000, errorMessage='Error while compiling statement: FAILED: RuntimeException Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient'), operationHandle=None)
[2024-12-09T13:25:35.030+0000] {hive.py:475} INFO - 
                    INSERT INTO sales VALUES (
                        '88b47b70-b01f-462f-8b04-b395708ed576', '649-29-6775', 'B', 'Mandalay', 'Normal', 'Male', 
                        'Fashion accessories', 33.52000045776367, 1, 1.6759999990463257, 35.19599914550781, 
                        '2/8/2019', '15:31', 'Cash', 33.52000045776367, 4.761904716491699, 
                        1.6759999990463257, 6.699999809265137
                    )
                
[2024-12-09T13:26:25.948+0000] {job.py:229} INFO - Heartbeat recovered after 196.45 seconds
