[2024-12-01T12:42:04.596+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2024-12-01T12:42:04.626+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: send_csv_to_kafka.send_csv_to_kafka manual__2024-12-01T12:41:59.507104+00:00 [queued]>
[2024-12-01T12:42:04.644+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: send_csv_to_kafka.send_csv_to_kafka manual__2024-12-01T12:41:59.507104+00:00 [queued]>
[2024-12-01T12:42:04.645+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 2
[2024-12-01T12:42:04.691+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): send_csv_to_kafka> on 2024-12-01 12:41:59.507104+00:00
[2024-12-01T12:42:04.703+0000] {logging_mixin.py:190} WARNING - /home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=726) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2024-12-01T12:42:04.705+0000] {standard_task_runner.py:72} INFO - Started process 740 to run task
[2024-12-01T12:42:04.705+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'send_csv_to_kafka', 'send_csv_to_kafka', 'manual__2024-12-01T12:41:59.507104+00:00', '--job-id', '41', '--raw', '--subdir', 'DAGS_FOLDER/dag_test.py', '--cfg-path', '/tmp/tmp22ia6efx']
[2024-12-01T12:42:04.707+0000] {standard_task_runner.py:105} INFO - Job 41: Subtask send_csv_to_kafka
[2024-12-01T12:42:04.815+0000] {task_command.py:467} INFO - Running <TaskInstance: send_csv_to_kafka.send_csv_to_kafka manual__2024-12-01T12:41:59.507104+00:00 [running]> on host 45770b1a429e
[2024-12-01T12:42:04.958+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='send_csv_to_kafka' AIRFLOW_CTX_TASK_ID='send_csv_to_kafka' AIRFLOW_CTX_EXECUTION_DATE='2024-12-01T12:41:59.507104+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-12-01T12:41:59.507104+00:00'
[2024-12-01T12:42:04.960+0000] {taskinstance.py:731} INFO - ::endgroup::
[2024-12-01T12:42:05.036+0000] {dag_test.py:43} INFO - Loaded CSV Data:
    Invoice ID Branch       City  ... gross margin percentage gross income Rating
0  750-67-8428      A     Yangon  ...                4.761905      26.1415    9.1
1  226-31-3081      C  Naypyitaw  ...                4.761905       3.8200    9.6
2  631-41-3108      A     Yangon  ...                4.761905      16.2155    7.4
3  123-19-1176      A     Yangon  ...                4.761905      23.2880    8.4
4  373-73-7910      A     Yangon  ...                4.761905      30.2085    5.3

[5 rows x 17 columns]
[2024-12-01T12:42:05.038+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '750-67-8428', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Female', 'Product line': 'Health and beauty', 'Unit price': 74.69, 'Quantity': 7, 'Tax 5%': 26.1415, 'Total': 548.9715, 'Date': '1/5/2019', 'Time': '13:08', 'Payment': 'Ewallet', 'cogs': 522.83, 'gross margin percentage': 4.761904762, 'gross income': 26.1415, 'Rating': 9.1}
[2024-12-01T12:42:05.039+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '750-67-8428', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Female', 'Product line': 'Health and beauty', 'Unit price': 74.69, 'Quantity': 7, 'Tax 5%': 26.1415, 'Total': 548.9715, 'Date': '1/5/2019', 'Time': '13:08', 'Payment': 'Ewallet', 'cogs': 522.83, 'gross margin percentage': 4.761904762, 'gross income': 26.1415, 'Rating': 9.1, 'id': '36dee2ae-d1cc-45e5-96b9-302c56d3a104'}
[2024-12-01T12:42:05.059+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '226-31-3081', 'Branch': 'C', 'City': 'Naypyitaw', 'Customer type': 'Normal', 'Gender': 'Female', 'Product line': 'Electronic accessories', 'Unit price': 15.28, 'Quantity': 5, 'Tax 5%': 3.82, 'Total': 80.22, 'Date': '3/8/2019', 'Time': '10:29', 'Payment': 'Cash', 'cogs': 76.4, 'gross margin percentage': 4.761904762, 'gross income': 3.82, 'Rating': 9.6}
[2024-12-01T12:42:05.060+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '226-31-3081', 'Branch': 'C', 'City': 'Naypyitaw', 'Customer type': 'Normal', 'Gender': 'Female', 'Product line': 'Electronic accessories', 'Unit price': 15.28, 'Quantity': 5, 'Tax 5%': 3.82, 'Total': 80.22, 'Date': '3/8/2019', 'Time': '10:29', 'Payment': 'Cash', 'cogs': 76.4, 'gross margin percentage': 4.761904762, 'gross income': 3.82, 'Rating': 9.6, 'id': '2ea54dcc-c86a-4ce2-9936-4b737bbd3a51'}
[2024-12-01T12:42:05.061+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '631-41-3108', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Normal', 'Gender': 'Male', 'Product line': 'Home and lifestyle', 'Unit price': 46.33, 'Quantity': 7, 'Tax 5%': 16.2155, 'Total': 340.5255, 'Date': '3/3/2019', 'Time': '13:23', 'Payment': 'Credit card', 'cogs': 324.31, 'gross margin percentage': 4.761904762, 'gross income': 16.2155, 'Rating': 7.4}
[2024-12-01T12:42:05.062+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '631-41-3108', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Normal', 'Gender': 'Male', 'Product line': 'Home and lifestyle', 'Unit price': 46.33, 'Quantity': 7, 'Tax 5%': 16.2155, 'Total': 340.5255, 'Date': '3/3/2019', 'Time': '13:23', 'Payment': 'Credit card', 'cogs': 324.31, 'gross margin percentage': 4.761904762, 'gross income': 16.2155, 'Rating': 7.4, 'id': '06a9d882-1d8c-46df-b7df-10056180f36f'}
[2024-12-01T12:42:05.064+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '123-19-1176', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Male', 'Product line': 'Health and beauty', 'Unit price': 58.22, 'Quantity': 8, 'Tax 5%': 23.288, 'Total': 489.048, 'Date': '1/27/2019', 'Time': '20:33', 'Payment': 'Ewallet', 'cogs': 465.76, 'gross margin percentage': 4.761904762, 'gross income': 23.288, 'Rating': 8.4}
[2024-12-01T12:42:05.065+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '123-19-1176', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Male', 'Product line': 'Health and beauty', 'Unit price': 58.22, 'Quantity': 8, 'Tax 5%': 23.288, 'Total': 489.048, 'Date': '1/27/2019', 'Time': '20:33', 'Payment': 'Ewallet', 'cogs': 465.76, 'gross margin percentage': 4.761904762, 'gross income': 23.288, 'Rating': 8.4, 'id': '55f14416-737e-4e6c-b1cc-3dc666981b48'}
[2024-12-01T12:42:05.067+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '373-73-7910', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Normal', 'Gender': 'Male', 'Product line': 'Sports and travel', 'Unit price': 86.31, 'Quantity': 7, 'Tax 5%': 30.2085, 'Total': 634.3785, 'Date': '2/8/2019', 'Time': '10:37', 'Payment': 'Ewallet', 'cogs': 604.17, 'gross margin percentage': 4.761904762, 'gross income': 30.2085, 'Rating': 5.3}
[2024-12-01T12:42:05.068+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '373-73-7910', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Normal', 'Gender': 'Male', 'Product line': 'Sports and travel', 'Unit price': 86.31, 'Quantity': 7, 'Tax 5%': 30.2085, 'Total': 634.3785, 'Date': '2/8/2019', 'Time': '10:37', 'Payment': 'Ewallet', 'cogs': 604.17, 'gross margin percentage': 4.761904762, 'gross income': 30.2085, 'Rating': 5.3, 'id': '5efc2df4-b557-468b-a6ca-e93d8a1c0da5'}
[2024-12-01T12:42:05.072+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '699-14-3026', 'Branch': 'C', 'City': 'Naypyitaw', 'Customer type': 'Normal', 'Gender': 'Male', 'Product line': 'Electronic accessories', 'Unit price': 85.39, 'Quantity': 7, 'Tax 5%': 29.8865, 'Total': 627.6165, 'Date': '3/25/2019', 'Time': '18:30', 'Payment': 'Ewallet', 'cogs': 597.73, 'gross margin percentage': 4.761904762, 'gross income': 29.8865, 'Rating': 4.1}
[2024-12-01T12:42:05.073+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '699-14-3026', 'Branch': 'C', 'City': 'Naypyitaw', 'Customer type': 'Normal', 'Gender': 'Male', 'Product line': 'Electronic accessories', 'Unit price': 85.39, 'Quantity': 7, 'Tax 5%': 29.8865, 'Total': 627.6165, 'Date': '3/25/2019', 'Time': '18:30', 'Payment': 'Ewallet', 'cogs': 597.73, 'gross margin percentage': 4.761904762, 'gross income': 29.8865, 'Rating': 4.1, 'id': '913c1671-62b1-47f1-8b1b-f6bb88fbb44a'}
[2024-12-01T12:42:05.075+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '355-53-5943', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Female', 'Product line': 'Electronic accessories', 'Unit price': 68.84, 'Quantity': 6, 'Tax 5%': 20.652, 'Total': 433.692, 'Date': '2/25/2019', 'Time': '14:36', 'Payment': 'Ewallet', 'cogs': 413.04, 'gross margin percentage': 4.761904762, 'gross income': 20.652, 'Rating': 5.8}
[2024-12-01T12:42:05.076+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '355-53-5943', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Female', 'Product line': 'Electronic accessories', 'Unit price': 68.84, 'Quantity': 6, 'Tax 5%': 20.652, 'Total': 433.692, 'Date': '2/25/2019', 'Time': '14:36', 'Payment': 'Ewallet', 'cogs': 413.04, 'gross margin percentage': 4.761904762, 'gross income': 20.652, 'Rating': 5.8, 'id': 'deabf808-cdb9-4426-8c18-3d872bf7d8c6'}
[2024-12-01T12:42:05.077+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '315-22-5665', 'Branch': 'C', 'City': 'Naypyitaw', 'Customer type': 'Normal', 'Gender': 'Female', 'Product line': 'Home and lifestyle', 'Unit price': 73.56, 'Quantity': 10, 'Tax 5%': 36.78, 'Total': 772.38, 'Date': '2/24/2019', 'Time': '11:38', 'Payment': 'Ewallet', 'cogs': 735.6, 'gross margin percentage': 4.761904762, 'gross income': 36.78, 'Rating': 8.0}
[2024-12-01T12:42:05.078+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '315-22-5665', 'Branch': 'C', 'City': 'Naypyitaw', 'Customer type': 'Normal', 'Gender': 'Female', 'Product line': 'Home and lifestyle', 'Unit price': 73.56, 'Quantity': 10, 'Tax 5%': 36.78, 'Total': 772.38, 'Date': '2/24/2019', 'Time': '11:38', 'Payment': 'Ewallet', 'cogs': 735.6, 'gross margin percentage': 4.761904762, 'gross income': 36.78, 'Rating': 8.0, 'id': '1cdbbbf4-b107-4280-bdb7-fe59e28cfcc0'}
[2024-12-01T12:42:05.079+0000] {dag_test.py:51} INFO - Row data before serialization: {'Invoice ID': '665-32-9167', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Female', 'Product line': 'Health and beauty', 'Unit price': 36.26, 'Quantity': 2, 'Tax 5%': 3.626, 'Total': 76.146, 'Date': '1/10/2019', 'Time': '17:15', 'Payment': 'Credit card', 'cogs': 72.52, 'gross margin percentage': 4.761904762, 'gross income': 3.626, 'Rating': 7.2}
[2024-12-01T12:42:05.079+0000] {dag_test.py:62} INFO - Mapped data to Avro schema: {'Invoice ID': '665-32-9167', 'Branch': 'A', 'City': 'Yangon', 'Customer type': 'Member', 'Gender': 'Female', 'Product line': 'Health and beauty', 'Unit price': 36.26, 'Quantity': 2, 'Tax 5%': 3.626, 'Total': 76.146, 'Date': '1/10/2019', 'Time': '17:15', 'Payment': 'Credit card', 'cogs': 72.52, 'gross margin percentage': 4.761904762, 'gross income': 3.626, 'Rating': 7.2, 'id': '27bc19f5-9f8b-40a3-b6a7-89ff75c29617'}
[2024-12-01T12:42:05.981+0000] {dag_test.py:72} INFO - Toutes les données ont été publiées sur le topic test-topic.
[2024-12-01T12:42:05.985+0000] {python.py:240} INFO - Done. Returned value was: None
[2024-12-01T12:42:06.019+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2024-12-01T12:42:06.020+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=send_csv_to_kafka, task_id=send_csv_to_kafka, run_id=manual__2024-12-01T12:41:59.507104+00:00, execution_date=20241201T124159, start_date=20241201T124204, end_date=20241201T124206
[2024-12-01T12:42:06.172+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2024-12-01T12:42:06.211+0000] {taskinstance.py:3895} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-12-01T12:42:06.215+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
